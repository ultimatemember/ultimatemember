!function(a){function t(){this.M=[],this.defaultOptions={attributes:{},classes:"",duration:400,footer:"",header:"",size:"normal",template:""},this.defaultTemplate='<div class="um-modal"><span class="um-modal-close umModalClose">&times;</span><div class="um-modal-header"></div><div class="um-modal-body"></div><div class="um-modal-footer"></div></div>'}t.prototype={constructor:t,addModal:function(t,e,i){e=this.filterOptions(e);let n;if(e.template){let t=wp.template(e.template);t&&(n=a(t(e)))}n||(n=a(this.defaultTemplate),e.header?n.find(".um-modal-header").html(e.header):n.find(".um-modal-header").remove(),e.footer?n.find(".um-modal-footer").html(e.footer):n.find(".um-modal-footer").remove());let d=n.find(".um-modal-body");switch(typeof t){case"function":let o=t.apply(n,[i,e]);"object"==typeof o&&"number"==typeof o.readyState&&"function"==typeof o.done?(wp.hooks.doAction("um-modal-before-ajax",n,e,o),this.loading(!0,n),o.done(function(t){wp.hooks.doAction("um-modal-after-ajax",n,t,o),UM.modal.loading(!1,n)})):this.setContent(o,n);break;case"object":this.setContent(a(t).clone(),n);break;case"string":"loading"===t?this.loading(!0,n):/^https?:/.test(t)?(this.loading(!0,n),d.load(t.trim(),function(){this.loading(!1,n),UM.modal.responsive(n)})):/^(#|\.)/.test(t)&&a(t).length?this.setContent(a(t).clone().children(),n):this.setContent(t,n);break;default:this.setContent(t,n)}if("object"==typeof(n.get(0).umModalOptions=e).attributes)for(var o in e.attributes)n.attr(o,e.attributes[o]);return e.classes.length&&n.addClass(e.classes),e.size.length&&n.addClass(e.size),n.on("click",'a:not([href^="javascript"])',this.stopEvent),n.on("touchmove",this.stopEvent),d.find("img").on("load",function(){UM.modal.responsive(n)}),wp.hooks.doAction("um-modal-before-add",n,e),this.hide(),this.M.push(n),this.show(n),n},addOverlay:function(){return a("body > .um-modal-overlay").length<1&&a(document.body).addClass("um-overflow-hidden").append('<div class="um-modal-overlay"></div>').on("touchmove",this.stopEvent),a("body > .um-modal-overlay")},clear:function(){this.M=[],a(document.body).removeClass("um-overflow-hidden").off("touchmove").children(".um-modal-overlay, .um-modal").remove(),"hidden"===a(document.body).css("overflow-y")&&a(document.body).css("overflow-y","visible")},close:function(){var t=this.getModal();return t&&t.length&&wp.hooks.doAction("um-modal-before-close",t),1<this.M.length?(this.M.pop().remove(),this.show()):this.clear(),this},filterOptions:function(t){var o=wp.hooks.applyFilters("um-modal-def-options",this.defaultOptions);return a.extend({},o,t)},getModal:function(e){let i;return"object"==typeof e?i=a(e):"string"==typeof e&&1<=this.M.length?a.each(this.M,function(t,o){o.is(e)&&(i=o)}):i=1<=this.M.length?this.M[this.M.length-1]:a("div.um-modal:not(.um-modal-hidden)").filter(":visible"),i.length?i.last():null},hide:function(t){let o=this.getModal(t);return o&&(o.detach(),wp.hooks.doAction("um-modal-hidden",o)),o},loading:function(t,o){let e=this.getModal(o);return t?(e.addClass("loading"),e.on("click",this.stopEvent)):(e.removeClass("loading"),e.off("click")),this},responsive:function(e){let i=this.getModal(e);if(i){i.removeClass("uimob340").removeClass("uimob500").removeClass("uimob800").removeClass("uimob960");var n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,e=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let t=i.find(".um-modal-body > img").filter(":visible"),o={};t.length?(t.css({maxHeight:.8*e,maxWidth:.8*n}),o.bottom=(e-i.innerHeight())/2+"px",o.marginLeft="-"+t.width()/2+"px",o.width=t.width()):n<=340?(o.bottom=0,o.height=e,o.width=n,i.addClass("uimob340")):n<=500?(o.bottom=0,o.height=e,o.width=n,i.addClass("uimob500")):n<=800?(o.bottom=(e-i.innerHeight())/2+"px",o.maxHeight=e,i.addClass("uimob800"),o.maxHeight=e):n<=960?(o.bottom=(e-i.innerHeight())/2+"px",o.maxHeight=e,i.addClass("uimob960")):960<n&&(o.bottom=(e-i.innerHeight())/2+"px",o.maxHeight=e),i.width()>n&&(o.width=.9*n,o.marginLeft="-"+o.width/2+"px"),o=wp.hooks.applyFilters("um-modal-responsive",o,i),i.css(o)}return this},setContent:function(t,o){let e=this.getModal(o);return e&&(e.find(".um-modal-body").html(t),wp.hooks.doAction("um-modal-content-added",e)),this},show:function(t){let o=this.getModal(t);return o&&(t=o.get(0).umModalOptions,this.addOverlay().after(o),this.responsive(o),o.animate({opacity:1},t.duration),wp.hooks.doAction("um-modal-shown",o)),o},stopEvent:function(t){t.preventDefault(),t.stopPropagation()}},void 0===window.UM&&(window.UM={}),UM.modal=new t,a(document.body).on("click",".umModalBtn",function(o){let t=a(o.currentTarget);var e=t.data();if("string"==typeof e.content){let t=e.content;"function"==typeof window[t]&&(t=window[t]),UM.modal.addModal(t,e,o)}}),a(document.body).on("click",".um-modal-overlay, .umModalClose",function(t){t.preventDefault(),UM.modal.close()}),a.fn.umModal=function(t){UM.modal.addModal(this.clone(),t)},a.fn.umModalBtn=function(o,e){this.on("click",function(t){t.preventDefault(),UM.modal.addModal(o,e,t)})}}(jQuery);