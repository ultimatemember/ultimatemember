function um_time_convert(e,t){var r=Math.floor(e/60),e=e%60;return(r=60<=e&&(e=0,24<=(r+=1))?0:r)+":"+(e=e<10?"0"+e:e)}function um_build_template(e,t){var r=e.getLayout();jQuery(".um-"+e.hash).length&&(e.wrapper.find(".um-members-wrapper").html("").prepend(t["content_"+r]),""!==t.counter?e.wrapper.find(".um-members-counter").text(t.counter).show():e.wrapper.find(".um-members-counter").text(t.counter).hide(),e.wrapper.addClass("um-loaded"),jQuery(document).trigger("um_build_template",[e,t]),jQuery(window).trigger("resize"),wp.hooks.doAction("um_member_directory_build_template",e.wrapper),UM.common.tipsy.init())}"object"!=typeof window.UM&&(window.UM={}),"object"!=typeof UM.frontend&&(UM.frontend={}),UM.frontend.directories={list:[],getHash:function(e){return e.data("hash")},filtersHash:function(t){let r=0;for(let e=0;e<t.length;e++){var i=t.charCodeAt(e);r=(r<<5)-r+i,r|=0}return r},filters:{checkEmpty:function(e){var t=e.find(".um-clear-filters-a"),e=e.find(".um-search-filter-field");let i=0;return e.each(function(){var e,t,r=jQuery(this).parents(".um-search-filter").data("filter-type");"text"===r?""===jQuery(this).val()&&i++:"select"===r?0===jQuery(this).val().length&&i++:"slider"===r?(t=(e=jQuery(this).parents(".um-range-container")).find(".um-from-slider")[0],e=e.find(".um-to-slider")[0],parseInt(t.value,10)===parseInt(t.min,10)&&parseInt(e.value,10)===parseInt(e.max,10)&&i++):"datepicker"===r?(e=(t=jQuery(this).parents(".um-date-range-row")).find('[data-range="from"]'),t=t.find('[data-range="to"]'),""===e.val()&&""===t.val()&&i++):"timepicker"===r&&(t=(e=jQuery(this).parents(".um-time-range-row")).find('[data-range="from"]'),r=e.find('[data-range="to"]'),""===t.val())&&""===r.val()&&i++}),e.length===i?t.addClass("um-hidden").prop("disabled",!0):t.removeClass("um-hidden").prop("disabled",!1),e.length===i}}},UM.frontend.directory=function(e){this.hash=e,this.wrapper=jQuery('.um-directory[data-hash="'+e+'"]'),this.defaultOrder=this.wrapper.data("default-order"),this.defaultLayout=this.wrapper.data("default-layout")},UM.frontend.directory.prototype={hash:"",wrapper:null,busy:!1,lastResponse:null,page:1,totalPages:0,search:"",order:"",defaultOrder:"",defaultLayout:"",filters:{},layout:"",getDataFromURL:function(e){let t=this.hash,r={},i=UM.frontend.url.parseData();if(jQuery.each(i,function(e){-1!==e.indexOf("_"+t)&&""!==i[e]&&(r[e.replace("_"+t,"")]=i[e])}),!e)return r;if(void 0!==r[e])try{r[e]=decodeURIComponent(r[e])}catch(e){console.error(e)}return r[e]},setDataToURL:function(t,r){let i=this.hash,a=this.getDataFromURL(),s={},o=(Array.isArray(r)?(jQuery.each(r,function(e){r[e]=encodeURIComponent(r[e])}),r=r.join("||")):Number.isFinite(r)||(r=r.split("||"),jQuery.each(r,function(e){r[e]=encodeURIComponent(r[e])}),r=r.join("||")),""!==r&&(s[t+"_"+i]=r),jQuery.each(a,function(e){t===e?""!==r&&(s[e+"_"+i]=r):s[e+"_"+i]=a[e]}),jQuery.each(UM.frontend.directories.list,function(r){if(r!==i){let t=UM.frontend.directories.list[r].getDataFromURL();jQuery.each(t,function(e){s[e+"_"+r]=t[e]})}}),[]),e=(jQuery.each(s,function(e){o.push(e+"="+s[e])}),"?"+(o=wp.hooks.applyFilters("um_member_directory_url_attrs",o)).join("&"));"?"===e&&(e=""),window.history.pushState("string","UM Member Directory",window.location.origin+window.location.pathname+e)},setLastResponse:function(e){this.lastResponse=e},setTotalPages:function(e){this.totalPages=e},getLastResponse:function(){return this.lastResponse},setLayout:function(r,i){var a=this.wrapper.find(".um-member-view-switcher");if(a.length){let e=!1,t=(void 0!==i&&i.hasOwnProperty("ignoreURL")&&!1!==i.ignoreURL&&(e=!0),!1);void 0!==i&&i.hasOwnProperty("updateUI")&&!1!==i.updateUI&&(t=!0),""===r&&(r=this.defaultLayout),t&&(i=a.find(".um-member-directory-view-type.current").data("type"),this.wrapper.find(".um-members-wrapper.um-members-"+i).removeClass("um-members-"+i),this.wrapper.find(".um-members-wrapper").addClass("um-members-"+r),a.find(".um-member-directory-view-type").removeClass("current"),a.find('.um-member-directory-view-type[data-type="'+r+'"]').addClass("current")),this.layout=r,e||(this.defaultLayout===r?this.setDataToURL("view_type",""):this.setDataToURL("view_type",r))}else this.layout=this.defaultLayout},getLayout:function(){return this.layout},isBusy:function(){return this.busy},getHash:function(){return this.hash},getWrapper:function(){return this.wrapper},preloaderShow:function(){this.busy=!0,this.wrapper.addClass("um-processing")},preloaderHide:function(){this.busy=!1,this.wrapper.removeClass("um-processing")},getPage:function(){return this.page},setPage:function(e,t){let r=!1,i=(void 0!==t&&t.hasOwnProperty("ignoreURL")&&!1!==t.ignoreURL&&(r=!0),!1);(i=void 0!==t&&t.hasOwnProperty("updateUI")&&!1!==t.updateUI?!0:i)&&this.wrapper.find(".um-members-pagination-box").umHide(),e=(e=parseInt(e))||1;t=parseInt(this.wrapper.data("total_pages"));t&&(e=e<=(t=t||1)?e:t),this.page=e,r||(1===e?this.setDataToURL("page",""):this.setDataToURL("page",e))},getOrder:function(){return this.order},setOrder:function(e,t){let r=!1,i=(void 0!==t&&t.hasOwnProperty("ignoreURL")&&!1!==t.ignoreURL&&(r=!0),!1);(i=void 0!==t&&t.hasOwnProperty("updateUI")&&!1!==t.updateUI?!0:i)&&this.wrapper.find(".um-member-directory-sorting").length&&((t=this.wrapper.find('.um-new-dropdown[data-element=".um-member-directory-sorting-a"]')).find("a").data("selected",0).prop("data-selected",0).attr("data-selected",0),t.find('a[data-value="'+e+'"]').data("selected",1).prop("data-selected",1).attr("data-selected",1),this.wrapper.find(".um-member-directory-sorting-a").find("> a").html(t.find('a[data-value="'+e+'"]').html())),this.order=e,r||(this.defaultOrder===e?this.setDataToURL("sort",""):this.setDataToURL("sort",e))},getSearch:function(){return this.search},setSearch:function(e,t){let r=!1,i=(void 0!==t&&t.hasOwnProperty("ignoreURL")&&!1!==t.ignoreURL&&(r=!0),!1);if(void 0!==t&&t.hasOwnProperty("updateUI")&&!1!==t.updateUI&&(i=!0),this.search=e,i){let e=this.getDataFromURL("search");void 0===e&&(e=""),this.wrapper.find(".um-search-line").val(e)}r||(""===e?this.setDataToURL("search",""):this.setDataToURL("search",e))},hasSearched:function(){return""!==this.getSearch()||0!==Object.keys(this.getFilters()).length},getFilters:function(){return this.filters},setFilters:function(n=!1){let d=this;var e=d.wrapper.find(".um-filters-form"),t=e.find(".um-search-filter-field");let u={};t.each(function(){var r=jQuery(this).parents(".um-search-filter"),e=r.data("filter-type"),r=r.data("filter-name");if("text"===e){var i=UM.common.form.sanitizeValue(jQuery(this).val());""!==i&&(u[r]=i),n||d.setDataToURL("filter_"+r,i)}else if("select"===e){var a=jQuery(this).val();let t=[];for(let e=0;e<a.length;e++)t[e]=UM.common.form.sanitizeValue(a[e]);0!==t.length&&(u[r]=t),t=t.length?t.join("||"):"",n||d.setDataToURL("filter_"+r,t)}else if("slider"===e){var i=jQuery(this).parents(".um-range-container"),s=i.find(".um-from-slider")[0],i=i.find(".um-to-slider")[0],o=parseInt(s.value,10);let e;e=parseInt(s.value,10)===parseInt(s.min,10)?"":parseInt(s.value,10);var s=parseInt(i.value,10);let t;t=parseInt(i.value,10)===parseInt(i.max,10)?"":parseInt(i.value,10),""===e&&""===t||(u[r]=[o,s]),n||(d.setDataToURL("filter_"+r+"_from",e),d.setDataToURL("filter_"+r+"_to",t))}else"datepicker"===e?(o=(i=jQuery(this).parents(".um-date-range-row")).find('[data-range="from"]'),s=i.find('[data-range="to"]'),i=UM.common.form.sanitizeValue(o.val()),o=UM.common.form.sanitizeValue(s.val()),""===i&&""===o||(u[r]=[i,o]),n||(d.setDataToURL("filter_"+r+"_from",i),d.setDataToURL("filter_"+r+"_to",o))):"timepicker"===e&&(i=(s=jQuery(this).parents(".um-time-range-row")).find('[data-range="from"]'),o=s.find('[data-range="to"]'),e=UM.common.form.sanitizeValue(i.val()),s=UM.common.form.sanitizeValue(o.val()),""===e&&""===s||(u[r]=[e,s]),n||(d.setDataToURL("filter_"+r+"_from",e),d.setDataToURL("filter_"+r+"_to",s)))}),this.filters=u,UM.frontend.directories.filters.checkEmpty(e)&&e.find(".um-apply-filters").prop("disabled",!0)},resetFilters:function(){this.filters={};let r=this;r.wrapper.find(".um-filters-form").find(".um-search-filter-field").each(function(){var e=jQuery(this).parents(".um-search-filter"),t=e.data("filter-type"),e=e.data("filter-name");"text"===t||"select"===t?r.setDataToURL("filter_"+e,""):"slider"!==t&&"datepicker"!==t&&"timepicker"!==t||(r.setDataToURL("filter_"+e+"_from",""),r.setDataToURL("filter_"+e+"_to",""))})},request:function(e){let t=!1;if((t=void 0!==e&&e.hasOwnProperty("pagination")&&!1!==e.pagination?!0:t)||this.preloaderShow(),this.wrapper.find(".um-member-directory-must-search").umHide(),this.wrapper.find(".um-member-directory-empty-search-result").umHide(),this.wrapper.find(".um-member-directory-empty-no-search-result").umHide(),this.wrapper.find(".um-member-directory-sorting .um-dropdown-wrapper .um-button").prop("disabled",!0),this.wrapper.find(".um-member-view-switcher").addClass("um-disabled"),t?this.wrapper.find(".um-members-wrapper .um-member").addClass("um-skeleton-mode"):(this.wrapper.find(".um-members-counter").text(""),this.wrapper.find(".um-members-wrapper").umHide(),this.wrapper.find(".um-members-pagination-box").umHide()),wp.hooks.applyFilters("um_member_directory_get_members_allow",!0,this)){var r,i=-(new Date).getTimezoneOffset()/60,a={directory_id:this.getHash(),page:this.getPage(),search:this.getSearch(),sorting:this.getOrder(),gmt_offset:i,post_refferer:this.wrapper.data("base-post"),nonce:this.wrapper.data("nonce")},s=this.getFilters();for(r in s)a[r]=s[r];a=wp.hooks.applyFilters("um_member_directory_filter_request",a);let t=this;wp.ajax.send("um_get_members",{data:a,success:function(e){t.setLastResponse(e),t.setTotalPages(e.total_pages),um_build_template(t,e),t.wrapper.find(".um-members-pagination-box").html(e.pagination),t.wrapper.data("total_pages",e.total_pages),e.total_pages?(t.wrapper.find(".um-member-directory-sorting .um-dropdown-wrapper .um-button").prop("disabled",!1),t.wrapper.find(".um-member-view-switcher").removeClass("um-disabled"),t.wrapper.find(".um-member-directory-header").umShow(),t.wrapper.find(".um-members-wrapper").umShow(),t.wrapper.find(".um-members-pagination-box").umShow(),t.wrapper.find(".um-member-directory-header-row-grid").umShow()):t.hasSearched()?(t.wrapper.find(".um-member-directory-empty-search-result").umShow(),t.wrapper.find(".um-member-directory-header").umShow(),t.wrapper.find(".um-member-directory-header-row-grid").umHide()):t.wrapper.find(".um-member-directory-empty-no-search-result").umShow(),wp.hooks.doAction("um_member_directory_loaded",t.wrapper,e),um_init_new_dropdown(),UM.frontend.slider.init(),t.preloaderHide()},error:function(e){console.log(e),(t.hasSearched()?t.wrapper.find(".um-member-directory-empty-search-result"):t.wrapper.find(".um-member-directory-empty-no-search-result")).umShow(),t.preloaderHide()}})}else setTimeout(this.request,600,e)}},jQuery(document.body).ready(function(){function t(e){var t=UM.frontend.directories.getHash(e),t=UM.frontend.directories.list[t];if(!t.isBusy()){var r=t.getDataFromURL("search"),i=UM.common.form.sanitizeValue(e.find(".um-search-line").val());if(i!==r&&(""!==i||void 0!==r)){if(t.setSearch(i),t.setPage(1),!1===wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,e)){r=parseInt(e.data("must-search"));if(1===r&&""===t.getSearch()&&0===Object.keys(t.getFilters()).length)return e.find(".um-member-directory-empty-search-result").umHide(),e.find(".um-member-directory-empty-no-search-result").umHide(),e.find(".um-member-directory-sorting .um-dropdown-wrapper .um-button").prop("disabled",!0),e.find(".um-member-view-switcher").addClass("um-disabled"),e.find(".um-member-directory-header-row-grid").umHide(),e.find(".um-members-wrapper").umHide(),e.find(".um-members-pagination-box").umHide(),void e.find(".um-member-directory-must-search").umShow()}t.request()}}}function o(e,t,r){var i=e.find('.um-pagination-item[data-page="prev"]'),e=e.find('.um-pagination-item[data-page="next"]');(1===t?(i.addClass("disabled"),e):t===r?(e.addClass("disabled"),i):(i.removeClass("disabled"),e)).removeClass("disabled")}jQuery(document.body).on("click",".um-user-action",function(e){if(e.preventDefault(),jQuery(this).data("confirm-onclick")&&!confirm(jQuery(this).data("confirm-onclick")))return wp.hooks.addFilter("um_dropdown_link_result","ultimate-member",function(e,t,r){return!r.data("confirm-onclick")&&e}),!1;wp.hooks.removeFilter("um_dropdown_link_result","ultimate-member")}),jQuery(document.body).on("click",".um-directory .um-member-view-switcher:not(.um-disabled) .um-button-in-group:not(.current)",function(){var e,t=jQuery(this),r=t.parents(".um-directory"),r=UM.frontend.directories.getHash(r),r=UM.frontend.directories.list[r];r.isBusy()||null!==(e=r.getLastResponse())&&(t=t.data("type"),r.setLayout(t,{updateUI:!0}),um_build_template(r,e),um_init_new_dropdown())}),jQuery(document.body).on("click",".um-directory .um-do-search",function(){t(jQuery(this).parents(".um-directory"))}),jQuery(document.body).on("keypress",".um-directory .um-search-line",function(e){13===e.which&&t(jQuery(this).parents(".um-directory"))}),jQuery(document.body).on("click",".um-members-sorting",function(e){var t,r,i;e.preventDefault(),1===jQuery(this).data("selected")||(e=jQuery(this).data("directory-hash"),(e=UM.frontend.directories.list[e]).isBusy())||(t=e.getWrapper(),r=jQuery(this).text(),i=jQuery(this).data("value"),t.find('.um-dropdown[data-element=".um-members-sorting-toggle"]').find("a").data("selected",0).prop("data-selected",0).attr("data-selected",0),t.find('.um-dropdown[data-element=".um-members-sorting-toggle"] a[data-value="'+i+'"]').data("selected",1).prop("data-selected",1).attr("data-selected",1),t.find(".um-members-sorting-toggle .um-button-content").text(r),e.setOrder(i),e.setPage(1),e.request())}),jQuery(document.body).on("click",".um-directory .um-pagination-item:not(.current)",function(){if(!jQuery(this).hasClass("disabled")){var t=jQuery(this).parents(".um-directory"),r=UM.frontend.directories.getHash(t),r=UM.frontend.directories.list[r];if(!r.isBusy()){var i=parseInt(t.data("total_pages")),a=r.getPage(),s=jQuery(this).data("page");let e;o(t,e="prev"===s?a-1:"next"===s?a+1:parseInt(s),i),t.find(".um-pagination-item").removeClass("current"),t.find('.um-pagination-item[data-page="'+e+'"]').addClass("current"),r.setPage(e),r.request({pagination:!0})}}}),jQuery(document.body).on("change",".um-directory .um-pagination-current-page-input",function(){if(!jQuery(this).hasClass("disabled")){var t=jQuery(this).parents(".um-directory"),r=UM.frontend.directories.getHash(t),r=UM.frontend.directories.list[r];if(!r.isBusy()){var i=r.getPage();let e=parseInt(jQuery(this).val());var a=parseInt(t.data("total_pages"));i!==e&&(e<1&&(jQuery(this).val(1),e=1),e>a&&(jQuery(this).val(a),e=a),o(t,e,a),r.setPage(e),r.request({pagination:!0}))}}}),jQuery(document.body).on("keypress",".um-directory .um-pagination-current-page-input",function(e){if(13===e.which)return jQuery(this).trigger("change"),!1}),jQuery(document.body).on("change",".um-search-filter-field",function(){var e=jQuery(this).parents(".um-filters-form"),t=e.find(".um-apply-filters");UM.frontend.directories.filters.checkEmpty(e),t.prop("disabled",!1)}),jQuery(document.body).on("reset",".um-directory .um-filters-form",function(){var e=jQuery(this).parents(".um-directory"),t=UM.frontend.directories.getHash(e),t=UM.frontend.directories.list[t];if(!t.isBusy()){var r=jQuery(this),i=r.find(".um-clear-filters-a"),r=r.find(".um-apply-filters"),i=(i.addClass("um-hidden").prop("disabled",!0),r.prop("disabled",!0),t.resetFilters(),t.setPage(1),wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,e));if(!1===i){r=parseInt(e.data("must-search"));if(1===r&&""===t.getSearch()&&0===Object.keys(t.getFilters()).length)return e.find(".um-member-directory-empty-search-result").umHide(),e.find(".um-member-directory-empty-no-search-result").umHide(),e.find(".um-member-directory-sorting .um-dropdown-wrapper .um-button").prop("disabled",!0),e.find(".um-member-view-switcher").addClass("um-disabled"),e.find(".um-member-directory-header-row-grid").umHide(),e.find(".um-members-wrapper").umHide(),e.find(".um-members-pagination-box").umHide(),void e.find(".um-member-directory-must-search").umShow()}t.request()}}),jQuery(document.body).on("click",".um-directory .um-apply-filters",function(e){e.preventDefault();var e=jQuery(this).parents(".um-directory"),t=UM.frontend.directories.getHash(e),t=UM.frontend.directories.list[t];if(!t.isBusy()){if(t.setFilters(),t.setPage(1),!1===wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,e)){var r=parseInt(e.data("must-search"));if(1===r&&""===t.getSearch()&&0===Object.keys(t.getFilters()).length)return e.find(".um-member-directory-empty-search-result").umHide(),e.find(".um-member-directory-empty-no-search-result").umHide(),e.find(".um-member-directory-sorting .um-dropdown-wrapper .um-button").prop("disabled",!0),e.find(".um-member-view-switcher").addClass("um-disabled"),e.find(".um-member-directory-header-row-grid").umHide(),e.find(".um-members-wrapper").umHide(),e.find(".um-members-pagination-box").umHide(),void e.find(".um-member-directory-must-search").umShow()}t.request()}}),wp.hooks.doAction("um_member_directory_on_first_pages_loading"),jQuery(".um-directory").each(function(){var e=jQuery(this),t=UM.frontend.directories.getHash(e),r=new UM.frontend.directory(t),t=(UM.frontend.directories.list[t]=r,wp.hooks.doAction("um_member_directory_on_init",e,t),r.getDataFromURL("view_type")),t=(void 0!==t?r.setLayout(t,{ignoreURL:!0}):r.setLayout(r.defaultLayout),r.getDataFromURL("page")),t=(void 0!==t&&r.setPage(t,{ignoreURL:!0}),r.getDataFromURL("search")),t=(void 0!==t&&r.setSearch(t,{ignoreURL:!0}),r.getDataFromURL("sort")),t=(void 0!==t&&r.setOrder(t,{ignoreURL:!0}),r.setFilters(!0),wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,e));if(!1===t){t=parseInt(e.data("must-search"));if(1===t&&""===r.getSearch()&&0===Object.keys(r.getFilters()).length)return}wp.hooks.applyFilters("um_member_directory_prevent_default_request",!1,r)||r.request({defaultRequest:!0})}),window.addEventListener("popstate",function(e){jQuery(".um-directory").each(function(){var e=jQuery(this),t=UM.frontend.directories.getHash(e),r=new UM.frontend.directory(t),i=(UM.frontend.directories.list[t]=r).getDataFromURL("page"),i=(void 0!==i?r.setPage(i,{ignoreURL:!0,updateUI:!0}):r.setPage("",{ignoreURL:!0,updateUI:!0}),r.getDataFromURL("search")),i=(void 0!==i?r.setSearch(i,{ignoreURL:!0,updateUI:!0}):r.setSearch("",{ignoreURL:!0,updateUI:!0}),r.getDataFromURL("sort")),i=(void 0!==i?r.setOrder(i,{ignoreURL:!0,updateUI:!0}):r.setOrder("",{ignoreURL:!0,updateUI:!0}),r.setFilters(!0),r.getDataFromURL("view_type")),i=(void 0!==i?r.setLayout(i,{ignoreURL:!0,updateUI:!0}):r.setLayout("",{ignoreURL:!0,updateUI:!0}),wp.hooks.applyFilters("um_member_directory_ignore_after_search",!1,e));if(!1===i){i=parseInt(e.data("must-search"));if(1===i&&""===r.getSearch()&&0===Object.keys(r.getFilters()).length)return}wp.hooks.applyFilters("um_member_directory_prevent_default_first_loading",!1,e,t)||r.request()})})}),wp.hooks.addFilter("um_toggle_block","um_member_directory",function(e,t){var r,i;return t.hasClass("um-meta-toggle")?(e=t.parents(".um-member").find(t.data("um-toggle")),r=t.data("toggle-text"),i=t.text(),t.data("toggle-text",i).text(r)):t.hasClass("um-filters-toggle")&&(e=t.parents(".um-directory").find(t.data("um-toggle"))),e}),wp.hooks.addFilter("um_common_child_dropdown_child_options_request","um_member_directory",function(e,t){return t.parents(".um-directory").length&&(e.member_directory=!0,e.member_directory_hash=t.parents(".um-directory").attr("data-hash")),e}),wp.hooks.addFilter("um_populate_child_options","um_member_directory",function(e,t){return e=t.parents(".um-directory").length?!0:e});