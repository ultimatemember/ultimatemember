wp.hooks.addFilter("um_uploader_data","ultimate-member",function(e,t,u){return("field-image"===t||"field-file"===t)&&((t=u.parents("form").find('input[name="user_id"]')).length&&(t=t.val())&&(e.url+="&user_id="+t),(t=u.parents("form").find('input[name="form_id"]')).length&&(t=t.val())&&(e.url+="&form_id="+t),t=u.parents(".um-field").data("key"))&&(e.url+="&field_id="+t),e}),wp.hooks.addFilter("um_uploader_file_uploaded","ultimate-member",function(e,t,u,r,a){var o=t.data("handler");return"field-image"!==o&&"field-file"!==o?e:((o=t.parents(".um-uploader").find(".um-uploader-filelist")).length&&((e=o.find("#"+r.id)).find(".um-uploaded-value").val(a.data[0].name_saved),e.find(".um-uploaded-value-hash").val(a.data[0].hash)),null)}),jQuery(document).ready(function(){jQuery(document.body).on("click",".um-user-posts-load-more",function(e){e.preventDefault();let u=jQuery(this),r=u.siblings(".um-user-profile-posts-loop"),a=+u.data("page")+1;u.prop("disabled",!0),u.siblings(".um-user-posts-loader").umShow(),wp.ajax.send("um_get_user_posts",{data:{author:u.data("author"),last_id:u.data("last_id"),nonce:u.data("nonce")},success:function(e){u.prop("disabled",!1),u.siblings(".um-user-posts-loader").umHide(),r.append(e.content);var t=+u.data("pages");a==t?u.remove():(u.data("page",a),u.data("last_id",e.last_id))},error:function(e){u.prop("disabled",!1),u.siblings(".um-user-posts-loader").umHide(),console.log(e)}})}),jQuery(document.body).on("click",".um-user-comments-load-more",function(e){e.preventDefault();let u=jQuery(this),r=u.siblings(".um-user-profile-comments-loop"),a=+u.data("page")+1;u.prop("disabled",!0),u.siblings(".um-user-comments-loader").umShow(),wp.ajax.send("um_get_user_comments",{data:{author:u.data("author"),last_id:u.data("last_id"),nonce:u.data("nonce")},success:function(e){u.prop("disabled",!1),u.siblings(".um-user-comments-loader").umHide(),r.append(e.content);var t=+u.data("pages");a==t?u.remove():(u.data("page",a),u.data("last_id",e.last_id))},error:function(e){u.prop("disabled",!1),u.siblings(".um-user-comments-loader").umHide(),console.log(e)}})}),jQuery(document.body).on("click",".um-user-action.um_delete",function(e){if(e.preventDefault(),!confirm(wp.i18n.__("Are you sure that you want to delete this user?","ultimate-member")))return wp.hooks.addFilter("um_dropdown_link_result","ultimate-member",function(e,t){return"um-user-action um_delete um-destructive"!==t&&e}),!1;wp.hooks.removeFilter("um_dropdown_link_result","ultimate-member")}),jQuery(document.body).on("click",".um-user-action.um_switch_user",function(e){if(e.preventDefault(),!confirm(wp.i18n.__("Are you sure that you want to switch to this user? It breaks your current session.","ultimate-member")))return wp.hooks.addFilter("um_dropdown_link_result","ultimate-member",function(e,t){return"um-user-action um_switch_user"!==t&&e}),!1;wp.hooks.removeFilter("um_dropdown_link_result","ultimate-member")}),jQuery(document.body).on("click",".um-photo-modal",function(e){e.preventDefault();jQuery(this).data("src");e=jQuery(this).html();return UM.modal.addModal({classes:"um-profile-field-photo-modal",duration:400,footer:"",header:"",size:"large",content:e,template:'<div class="um-modal"><span class="um-modal-close um-modal-close-fixed">&times;</span><div class="um-modal-body"></div></div>'},null),!1}),jQuery(".um-profile.um-viewing .um-profile-body .um-row").each(function(){var e=jQuery(this);0==e.find(".um-field").length&&(e.prev(".um-row-heading").remove(),e.remove())}),jQuery(".um-profile.um-viewing .um-profile-body").length&&0==jQuery(".um-profile.um-viewing .um-profile-body").find(".um-field").length&&(jQuery(".um-profile.um-viewing .um-profile-body").find(".um-row-heading,.um-row").remove(),jQuery(".um-profile-note").show()),jQuery(document.body).on("click",".um-profile-save",function(e){return e.preventDefault(),jQuery(this).parents(".um.um-profile.um-editing").find("form").trigger("submit"),!1}),jQuery(document.body).on("change keyup","#um-meta-bio",function(){if(void 0!==jQuery(this).val()){var t=jQuery(this).data("character-limit"),u=jQuery(this).data("html");let e=t-jQuery(this).val().length;e=(e=1===parseInt(u)?t-jQuery(this).val().replace(/(<([^>]+)>)/gi,"").length:e)<0?0:e,jQuery("span.um-meta-bio-character span.um-bio-limit").text(e);u=e<5?"red":"";jQuery("span.um-meta-bio-character").css("color",u)}}),jQuery("#um-meta-bio").trigger("change"),jQuery(".um-profile form").each(function(){let t=jQuery(this).data("description_key");jQuery(this).find('textarea[name="'+t+'"]').length&&jQuery(document.body).on("change input",'textarea[name="'+t+'"]',function(e){jQuery(this).parents("form").find('textarea[name="'+t+'"]').each(function(){jQuery(this).val(e.currentTarget.value),jQuery("#um-meta-bio")[0]!==e.currentTarget&&jQuery("#um-meta-bio")[0]===jQuery(this)[0]&&jQuery(this).trigger("change")})})}),jQuery(".um-profile-nav a").on("touchend",function(e){jQuery(e.currentTarget).trigger("click")})});