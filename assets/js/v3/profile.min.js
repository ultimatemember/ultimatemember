wp.hooks.addFilter("um_uploader_data","ultimate-member",function(e,t,r){return("field-image"===t||"field-file"===t)&&((t=r.parents("form").find('input[name="user_id"]')).length&&(t=t.val())&&(e.url+="&user_id="+t),(t=r.parents("form").find('input[name="form_id"]')).length&&(t=t.val())&&(e.url+="&form_id="+t),t=r.parents(".um-field").data("key"))&&(e.url+="&field_id="+t),e}),wp.hooks.addFilter("um_uploader_file_uploaded","ultimate-member",function(e,t,r,u,i){var a=t.data("handler");return"field-image"!==a&&"field-file"!==a?e:((a=t.parents(".um-uploader").find(".um-uploader-filelist")).length&&((e=a.find("#"+u.id)).find(".um-uploaded-value").val(i.data[0].name_saved),e.find(".um-uploaded-value-hash").val(i.data[0].hash)),null)}),jQuery(document).ready(function(){jQuery(document.body).on("click",".um-user-posts-load-more",function(e){e.preventDefault();let r=jQuery(this),u=r.siblings(".um-user-profile-posts-loop"),i=+r.data("page")+1;r.prop("disabled",!0),r.siblings(".um-user-posts-loader").umShow(),wp.ajax.send("um_get_user_posts",{data:{author:r.data("author"),last_id:r.data("last_id"),nonce:r.data("nonce")},success:function(e){r.prop("disabled",!1),r.siblings(".um-user-posts-loader").umHide(),u.append(e.content);var t=+r.data("pages");i==t?r.remove():(r.data("page",i),r.data("last_id",e.last_id))},error:function(e){r.prop("disabled",!1),r.siblings(".um-user-posts-loader").umHide(),console.log(e)}})}),jQuery(document.body).on("click",".um-user-comments-load-more",function(e){e.preventDefault();let r=jQuery(this),u=r.siblings(".um-user-profile-comments-loop"),i=+r.data("page")+1;r.prop("disabled",!0),r.siblings(".um-user-comments-loader").umShow(),wp.ajax.send("um_get_user_comments",{data:{author:r.data("author"),last_id:r.data("last_id"),nonce:r.data("nonce")},success:function(e){r.prop("disabled",!1),r.siblings(".um-user-comments-loader").umHide(),u.append(e.content);var t=+r.data("pages");i==t?r.remove():(r.data("page",i),r.data("last_id",e.last_id))},error:function(e){r.prop("disabled",!1),r.siblings(".um-user-comments-loader").umHide(),console.log(e)}})}),jQuery(document.body).on("click",".um-user-action.um_delete",function(e){if(e.preventDefault(),!confirm(wp.i18n.__("Are you sure that you want to delete this user?","ultimate-member")))return wp.hooks.addFilter("um_dropdown_link_result","ultimate-member",function(e,t){return"um-user-action um_delete um-destructive"!==t&&e}),!1;wp.hooks.removeFilter("um_dropdown_link_result","ultimate-member")}),jQuery(document.body).on("click",".um-user-action.um_switch_user",function(e){if(e.preventDefault(),!confirm(wp.i18n.__("Are you sure that you want to switch to this user? It breaks your current session.","ultimate-member")))return wp.hooks.addFilter("um_dropdown_link_result","ultimate-member",function(e,t){return"um-user-action um_switch_user"!==t&&e}),!1;wp.hooks.removeFilter("um_dropdown_link_result","ultimate-member")}),jQuery(".um-profile.um-viewing .um-profile-body .um-row").each(function(){var e=jQuery(this);0==e.find(".um-field").length&&(e.prev(".um-row-heading").remove(),e.remove())}),jQuery(".um-profile.um-viewing .um-profile-body").length&&0==jQuery(".um-profile.um-viewing .um-profile-body").find(".um-field").length&&(jQuery(".um-profile.um-viewing .um-profile-body").find(".um-row-heading,.um-row").remove(),jQuery(".um-profile-note").show()),jQuery(document.body).on("click",".um-profile-save",function(e){return e.preventDefault(),jQuery(this).parents(".um.um-profile.um-editing").find("form").trigger("submit"),!1}),jQuery(document.body).on("change keyup","#um-meta-bio",function(){if(void 0!==jQuery(this).val()){var t=jQuery(this).data("character-limit"),r=jQuery(this).data("html");let e=t-jQuery(this).val().length;e=(e=1===parseInt(r)?t-jQuery(this).val().replace(/(<([^>]+)>)/gi,"").length:e)<0?0:e,jQuery("span.um-meta-bio-character span.um-bio-limit").text(e);r=e<5?"red":"";jQuery("span.um-meta-bio-character").css("color",r)}}),jQuery("#um-meta-bio").trigger("change"),jQuery(".um-profile form").each(function(){let t=jQuery(this).data("description_key");jQuery(this).find('textarea[name="'+t+'"]').length&&jQuery(document.body).on("change input",'textarea[name="'+t+'"]',function(e){jQuery(this).parents("form").find('textarea[name="'+t+'"]').each(function(){jQuery(this).val(e.currentTarget.value),jQuery("#um-meta-bio")[0]!==e.currentTarget&&jQuery("#um-meta-bio")[0]===jQuery(this)[0]&&jQuery(this).trigger("change")})})}),jQuery(".um-profile-nav a").on("touchend",function(e){jQuery(e.currentTarget).trigger("click")})});