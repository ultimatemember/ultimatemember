function UM_Drag_and_Drop(){jQuery(".um-admin-drag-col,.um-admin-drag-group").sortable({items:".um-admin-drag-fld",connectWith:".um-admin-drag-col,.um-admin-drag-group",placeholder:"um-fld-placeholder",forcePlaceholderSize:!0,update:function(e,i){jQuery("#publish").attr("disabled","disabled"),i.item.hasClass("um-field-type-group")&&0<i.item.parents(".um-field-type-group").length?(jQuery(".um-admin-drag-col,.um-admin-drag-group").sortable("cancel"),jQuery("#publish").prop("disabled",!1)):(UM_Change_Field_Col(),UM_Change_Field_Grp(),UM_Rows_Refresh())}}),jQuery(".um-admin-drag-rowsubs").sortable({items:".um-admin-drag-rowsub",placeholder:"um-rowsub-placeholder",forcePlaceholderSize:!0,zIndex:9999999999,update:function(){jQuery("#publish").attr("disabled","disabled"),UM_update_subrows(),UM_Rows_Refresh()}}).disableSelection(),jQuery(".um-admin-drag-rowsub").sortable({items:".um-admin-drag-col",zIndex:9999999999,update:function(){jQuery("#publish").attr("disabled","disabled"),(row=jQuery(this)).find(".um-admin-drag-col").removeClass("cols-1 cols-2 cols-3 cols-last cols-middle"),row.find(".um-admin-drag-col").addClass("cols-"+row.find(".um-admin-drag-col").length),row.find(".um-admin-drag-col:last").addClass("cols-last"),3==row.find(".um-admin-drag-col").length&&row.find(".um-admin-drag-col:eq(1)").addClass("cols-middle"),UM_Change_Field_Col(),UM_Change_Field_Grp(),UM_Rows_Refresh()}}).disableSelection(),jQuery(".um-admin-drag-ajax").sortable({items:".um-admin-drag-row",handle:".um-admin-drag-row-start",zIndex:9999999999,placeholder:"um-row-placeholder",forcePlaceholderSize:!0,out:function(){UM.common.tipsy.hide()},update:function(){jQuery("#publish").attr("disabled","disabled"),UM_update_rows(),UM_Change_Field_Col(),UM_Change_Field_Grp(),UM_Rows_Refresh()}}).disableSelection()}function UM_update_rows(){var e=0;jQuery('a[data-remove_element="um-admin-drag-row"]').remove(),jQuery(".um-admin-drag-row").each(function(){e++,row=jQuery(this),1!=e&&row.find(".um-admin-drag-row-icons").append('<a href="#" class="um-tip-n" title="Delete Row" data-remove_element="um-admin-drag-row"><i class="um-faicon-trash-o"></i></a>')})}function UM_update_subrows(){jQuery('a[data-remove_element="um-admin-drag-rowsub"]').remove(),jQuery(".um-admin-drag-row").each(function(){c=0,jQuery(this).find(".um-admin-drag-rowsub").each(function(){c++,row=jQuery(this),1!=c&&row.find(".um-admin-drag-rowsub-icons").append('<a href="#" class="um-tip-n" title="Delete Row" data-remove_element="um-admin-drag-rowsub"><i class="um-faicon-trash-o"></i></a>')})})}function UM_Change_Field_Col(){jQuery(".um-admin-drag-col .um-admin-drag-fld").each(function(){cols=jQuery(this).parents(".um-admin-drag-rowsub").find(".um-admin-drag-col").length,(col=jQuery(this).parents(".um-admin-drag-col")).hasClass("cols-last")?(1==cols&&(saved_col=1),3==cols?saved_col=3:2==cols&&(saved_col=2)):saved_col=col.hasClass("cols-middle")&&3==cols?2:1,jQuery(this).data("column",saved_col)})}function UM_Change_Field_Grp(){jQuery(".um-admin-drag-col .um-admin-drag-fld:not(.um-field-type-group)").each(function(){0==jQuery(this).parents(".um-admin-drag-group").length?jQuery(this).data("group",""):jQuery(this).data("group",jQuery(this).parents(".um-admin-drag-fld.um-field-type-group").data("key"))})}function UM_Rows_Refresh(){jQuery(".um_update_order_fields").empty();var i,d=0;jQuery(".um-admin-drag-row").each(function(){d++,row=jQuery(this),col_num="",row.find(".um-admin-drag-rowsub").each(function(){(subrow=jQuery(this)).find(".um-admin-drag-col").removeClass("cols-1 cols-2 cols-3 cols-last cols-middle"),subrow.find(".um-admin-drag-col").addClass("cols-"+subrow.find(".um-admin-drag-col").length),subrow.find(".um-admin-drag-col:last").addClass("cols-last"),3==subrow.find(".um-admin-drag-col").length&&subrow.find(".um-admin-drag-col:eq(1)").addClass("cols-middle"),col_num=col_num?col_num+":"+subrow.find(".um-admin-drag-col").length:subrow.find(".um-admin-drag-col").length}),jQuery(".um_update_order_fields").append('<input type="hidden" name="_um_rowcols_'+d+'_cols" id="_um_rowcols_'+d+'_cols" value="'+col_num+'" />'),sub_rows_count=row.find(".um-admin-drag-rowsub").length;var e=jQuery(this).attr("data-original");jQuery(".um_update_order_fields").append('<input type="hidden" name="_um_row_'+d+'" id="_um_row_'+d+'" value="_um_row_'+d+'" />'),jQuery(".um_update_order_fields").append('<input type="hidden" name="_um_roworigin_'+d+'_val" id="_um_roworigin_'+d+'_val" value="'+e+'" />'),jQuery(".um_update_order_fields").append('<input type="hidden" name="_um_rowsub_'+d+'_rows" id="_um_rowsub_'+d+'_rows" value="'+sub_rows_count+'" />'),jQuery(this).attr("data-original","_um_row_"+d)}),i=0,jQuery(".um-admin-drag-col .um-admin-drag-fld").each(function(){var e;jQuery(this).hasClass("group")||(""!=(e=jQuery(this).data("group"))?(0==jQuery(".um-admin-drag-fld.um-field-type-group."+e).find(".um-admin-drag-group").find(jQuery(this)).length&&jQuery(this).appendTo(jQuery(".um-admin-drag-fld.um-field-type-group."+e).find(".um-admin-drag-group")),jQuery(".um_update_order_fields").append('<input type="hidden" name="um_group_'+jQuery(this).data("key")+'" id="um_group_'+jQuery(this).data("key")+'" value="'+e+'" />')):jQuery(".um_update_order_fields").append('<input type="hidden" name="um_group_'+jQuery(this).data("key")+'" id="um_group_'+jQuery(this).data("key")+'" value="" />')),i++,row="_um_row_"+(row=jQuery(this).parents(".um-admin-drag-row").index()+1),3==(saved_col=jQuery(this).data("column"))&&jQuery(this).appendTo(jQuery(this).parents(".um-admin-drag-rowsub").find(".um-admin-drag-col:eq(2)")),2==saved_col&&jQuery(this).appendTo(jQuery(this).parents(".um-admin-drag-rowsub").find(".um-admin-drag-col:eq(1)")),sub_row=jQuery(this).parents(".um-admin-drag-rowsub").index(),jQuery(".um_update_order_fields").append('<input type="hidden" name="um_position_'+jQuery(this).data("key")+'" id="um_position_'+jQuery(this).data("key")+'" value="'+i+'" />'),jQuery(".um_update_order_fields").append('<input type="hidden" name="um_row_'+jQuery(this).data("key")+'" id="um_row_'+jQuery(this).data("key")+'" value="'+row+'" />'),jQuery(".um_update_order_fields").append('<input type="hidden" name="um_subrow_'+jQuery(this).data("key")+'" id="um_subrow_'+jQuery(this).data("key")+'" value="'+sub_row+'" />'),jQuery(".um_update_order_fields").append('<input type="hidden" name="um_col_'+jQuery(this).data("key")+'" id="um_col_'+jQuery(this).data("key")+'" value="'+saved_col+'" />')}),UM_Drag_and_Drop(),UM_Add_Icon(),jQuery.ajax({url:wp.ajax.settings.url,type:"POST",data:jQuery(".um_update_order").serialize(),success:function(){jQuery("#publish").prop("disabled",!1)}})}function UM_Add_Icon(){var e='<a href="#" class="um-admin-drag-add-field um-tip-n" title="Add Field" data-modal="UM_fields" data-modal-size="normal" data-dynamic-content="um_admin_show_fields" data-arg2="'+jQuery(".um-admin-drag-ajax").data("form_id")+'" data-arg1=""><i class="um-icon-plus"></i></a>';jQuery(".um-admin-drag-col").each(function(){0==jQuery(this).find(".um-admin-drag-add-field").length||jQuery(this).find(".um-admin-drag-add-field").remove(),jQuery(this).append(e)}),jQuery(".um-admin-drag-group").each(function(){0==jQuery(this).find(".um-admin-drag-add-field").length||jQuery(this).find(".um-admin-drag-add-field").remove(),jQuery(this).append(e)})}function um_builder_delete_field_ajax(i){var e,d;0<UM.admin.builder.fieldsToDelete.length?(d=UM.admin.builder.fieldsToDelete.shift(),e=jQuery(d).find('[data-silent_action="um_admin_remove_field"]').data("arg1"),d=jQuery(d).find('[data-silent_action="um_admin_remove_field"]').data("arg2"),jQuery.ajax({url:wp.ajax.settings.url,type:"POST",data:{action:"um_do_ajax_action",act_id:"um_admin_remove_field",arg1:e,arg2:d,nonce:um_admin_scripts.nonce},success:function(e){um_builder_delete_field_ajax(i)},error:function(e){i()}})):i()}function um_form_select_tab(e,i){var d=jQuery("input#form__um_mode");e.parents(".um-admin-boxed-links").find("a").removeClass("um-admin-activebg"),e.addClass("um-admin-activebg"),jQuery(".um-admin div#side-sortables").show(),jQuery('div[id^="um-admin-form"]').hide(),jQuery("#submitdiv").show(),jQuery("div#um-admin-form-mode,div#um-admin-form-title,div#um-admin-form-builder,div#um-admin-form-shortcode").show(),jQuery('div[id^="um-admin-form-'+e.data("role")+'"]').show(),i&&d.val(e.data("role")),jQuery(".empty-container").css({border:"none"}),jQuery(".um-admin-builder").removeClass().addClass("um-admin-builder "+d.val())}function um_admin_update_builder(){var e=jQuery(".um-admin-builder").data("form_id");return jQuery.ajax({url:wp.ajax.settings.url,type:"POST",data:{action:"um_update_builder",form_id:e,nonce:um_admin_scripts.nonce},success:function(e){jQuery(".um-admin-drag-ajax").html(e),UM.common.tipsy.hide(),allow_update_via_col_click=!1,jQuery(".um-admin-drag-ctrls.columns a.active").each(function(){jQuery(this).trigger("click")}).promise().done(function(){allow_update_via_col_click=!0}),UM_Rows_Refresh()},error:function(e){}}),!1}"object"!=typeof window.UM&&(window.UM={}),"object"!=typeof window.UM.admin&&(window.UM.admin={}),UM.admin.builder={deleteProcess:[],fieldsToDelete:[],fieldConditions:{refresh:function(){var e=jQuery(".um-adm-conditional");0<e.length&&e.each(function(){jQuery(this).trigger("change")})}},tinyMCE:{editor:{},init:function(i,e){var d,a=jQuery("#"+i);("object"==typeof tinyMCE&&null!==tinyMCE.get(i)?(tinyMCE.triggerSave(),tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,i),"4"===tinyMCE.majorVersion?window.tinyMCE.execCommand("mceRemoveEditor",!0,i):window.tinyMCE.execCommand("mceRemoveControl",!0,i),UM.admin.builder.tinyMCE.editor=jQuery("<div>").append(a.parents("#wp-"+i+"-wrap").clone()),a.parents("#wp-"+i+"-wrap").replaceWith('<div class="um_tiny_placeholder"></div>'),jQuery(".um-admin-editor:visible").html(jQuery(UM.admin.builder.tinyMCE.editor).html()),d=void 0===tinyMCEPreInit.mceInit[i]?tinyMCEPreInit.mceInit[i]=tinyMCE.extend({},tinyMCEPreInit.mceInit[i]):tinyMCEPreInit.mceInit[i],"function"==typeof QTags&&(QTags(tinyMCEPreInit.qtInit[i]),QTags._buttonsInit()),"object"==typeof window.switchEditors&&window.switchEditors.go(i),tinyMCE.init(d),tinyMCE.get(i).setContent(e),a):(UM.admin.builder.tinyMCE.editor=jQuery("<div>").append(a.parents("#wp-"+i+"-wrap").clone()),a.parents("#wp-"+i+"-wrap").replaceWith('<div class="um_tiny_placeholder"></div>'),jQuery(".um-admin-editor:visible").html(jQuery(UM.admin.builder.tinyMCE.editor).html()),"function"==typeof QTags&&(QTags(tinyMCEPreInit.qtInit[i]),QTags._buttonsInit()),jQuery("#"+i))).html(e),jQuery("body").on("click",".wp-switch-editor",function(){var e=jQuery(this);e.hasClass("wp-switch-editor")&&"object"==typeof window.switchEditors&&(e=e.hasClass("switch-tmce")?"tmce":"html",window.switchEditors.go(i,e))})}},previewResize:function(){jQuery(".um-admin-modal-body > .um").length&&(jQuery(".um-admin-modal-body > .um").each(function(){(element_width=jQuery(this).width())<=340?(jQuery(this).removeClass("uimob340"),jQuery(this).removeClass("uimob500"),jQuery(this).removeClass("uimob800"),jQuery(this).removeClass("uimob960"),jQuery(this).addClass("uimob340")):element_width<=500?(jQuery(this).removeClass("uimob340"),jQuery(this).removeClass("uimob500"),jQuery(this).removeClass("uimob800"),jQuery(this).removeClass("uimob960"),jQuery(this).addClass("uimob500")):element_width<=800?(jQuery(this).removeClass("uimob340"),jQuery(this).removeClass("uimob500"),jQuery(this).removeClass("uimob800"),jQuery(this).removeClass("uimob960"),jQuery(this).addClass("uimob800")):element_width<=960?(jQuery(this).removeClass("uimob340"),jQuery(this).removeClass("uimob500"),jQuery(this).removeClass("uimob800"),jQuery(this).removeClass("uimob960"),jQuery(this).addClass("uimob960")):960<element_width&&(jQuery(this).removeClass("uimob340"),jQuery(this).removeClass("uimob500"),jQuery(this).removeClass("uimob800"),jQuery(this).removeClass("uimob960")),jQuery(this).css("opacity",1)}),jQuery(".um-admin-modal-body .um-cover, .um-admin-modal-body .um-cover-e").each(function(){var e=jQuery(this),i=e.data("ratio"),d=e.width(),i=i.split(":");calcHeight=Math.round(d/i[0])+"px",e.height(calcHeight),e.find(".um-cover-add").height(calcHeight)}))}},jQuery(window).on("resize",function(){UM.admin.builder.previewResize()}),wp.hooks.addAction("um_admin_modal_success_result","um_admin_builder",function(e,i){UM.admin.builder.fieldConditions.refresh(),jQuery("#_custom_dropdown_options_source").trigger("blur"),0<jQuery(".um-admin-editor:visible").length&&("um_admin_edit_field_popup"===i?UM.admin.builder.tinyMCE.init("um_editor_edit",jQuery(".um-admin-modal:visible .dynamic-mce-content").html()):UM.admin.builder.tinyMCE.init("um_editor_new","")),"um_admin_preview_form"===i&&(UM.admin.builder.previewResize(),"function"==typeof jQuery.fn.um_raty&&jQuery(".um-rating").um_raty({half:!1,starType:"i",number:function(){return jQuery(this).attr("data-number")},score:function(){return jQuery(this).attr("data-score")},scoreName:function(){return jQuery(this).attr("data-key")},hints:!1}),(i=jQuery(".um-admin-preview-overlay")).css("height",+i.siblings(".um").outerHeight(!0)+20+"px")),UM.admin.colorPicker.init(),UM.admin.iconSelector.init()}),wp.hooks.addAction("um_admin_modal_resize","um_admin_builder",function(){jQuery("#UM_preview_form .um-s1").length&&jQuery("#UM_preview_form .um-s1").css({display:"block"}).select2({allowClear:!0}),jQuery("#UM_preview_form .um-s2").length&&jQuery("#UM_preview_form .um-s2").css({display:"block"}).select2({allowClear:!1,minimumResultsForSearch:10})}),wp.hooks.addAction("um_admin_modal_remove","um_admin_builder",function(){0<jQuery(".um-admin-editor:visible").length&&(tinyMCE.triggerSave(),("UM_edit_field"==jQuery(".um-admin-modal:visible").find("form").parent().attr("id")?jQuery("#wp-um_editor_edit-wrap"):jQuery("#wp-um_editor_new-wrap")).remove(),jQuery(".um_tiny_placeholder").replaceWith(jQuery(UM.admin.builder.tinyMCE.editor).html()))}),jQuery(document).ready(function(){if(0<jQuery(".um-admin-boxed-links").length&&um_form_select_tab(jQuery('.um-admin-boxed-links a[data-role="'+jQuery("input#form__um_mode").val()+'"]'),!1),jQuery(".um-admin-boxed-links:not(.is-core-form) a").on("click",function(){um_form_select_tab(jQuery(this),!0)}),jQuery("#wpfooter").hide(),jQuery(document.body).on("change",".um-adm-conditional",function(){var e="checkbox"==jQuery(this).attr("type")?jQuery(this).is(":checked")?1:0:jQuery(this).val();if(jQuery(this).data("cond1"))if(e==jQuery(this).data("cond1")){if(jQuery("."+jQuery(this).data("cond1-show")).show(),jQuery("."+jQuery(this).data("cond1-hide")).hide(),"_roles"==jQuery(this).data("cond1-show"))return!1}else jQuery("."+jQuery(this).data("cond1-show")).hide(),jQuery("."+jQuery(this).data("cond1-hide")).show();if(jQuery(this).data("cond2"))if(e==jQuery(this).data("cond2")){if(jQuery("."+jQuery(this).data("cond2-show")).show(),jQuery("."+jQuery(this).data("cond2-hide")).hide(),"_roles"==jQuery(this).data("cond2-show"))return!1}else jQuery("."+jQuery(this).data("cond2-show")).hide(),jQuery("."+jQuery(this).data("cond2-hide")).show();jQuery(this).data("cond3")&&(e==jQuery(this).data("cond3")?(jQuery("."+jQuery(this).data("cond3-show")).show(),jQuery("."+jQuery(this).data("cond3-hide")).hide()):(jQuery("."+jQuery(this).data("cond3-show")).hide(),jQuery("."+jQuery(this).data("cond3-hide")).show()))}),jQuery(".um-adm-conditional").each(function(){jQuery(this).trigger("change")}),jQuery(document.body).on("click",'a[data-silent_action^="um_"]',function(){var e,i,d,a,n,r,o,t;return void 0===jQuery(this).attr("disabled")&&(e=jQuery(this).data("silent_action"),i=jQuery(this).data("arg1"),d=jQuery(this).data("arg2"),o=r=n=a="",(t=jQuery(".um-col-demon-settings")).data("in_column")&&(a=t.data("in_row"),n=t.data("in_sub_row"),r=t.data("in_column"),o=t.data("in_group")),UM.admin.modal.remove(),jQuery.ajax({url:wp.ajax.settings.url,type:"POST",data:{action:"um_do_ajax_action",act_id:e,arg1:i,arg2:d,in_row:a,in_sub_row:n,in_column:r,in_group:o,nonce:um_admin_scripts.nonce},success:function(e){t.data("in_row","").data("in_sub_row","").data("in_column","").data("in_group",""),UM.admin.modal.resize(),um_admin_update_builder()},error:function(e){}})),!1}),jQuery(document.body).on("click",".um-admin-btns a span.remove",function(e){var i;return e.preventDefault(),confirm(wp.i18n.__("This will permanently delete this custom field from a database and from all forms on your site. Are you sure?","ultimate-member"))&&(jQuery(this).parents("a").remove(),i=jQuery(this).parents("a").data("arg1"),jQuery.ajax({url:wp.ajax.settings.url,type:"POST",data:{action:"um_do_ajax_action",act_id:"um_admin_remove_field_global",arg1:i,nonce:um_admin_scripts.nonce},success:function(e){jQuery("#um-admin-form-builder ."+i).remove()},error:function(e){}})),!1}),jQuery(document.body).on("submit","form.um_add_field",function(e){e.preventDefault();var i=jQuery(".um-admin-cur-condition"),a=(jQuery(i).each(function(e){""!==jQuery(this).find('[id^="_conditional_action"]').val()&&""!==jQuery(this).find('[id^="_conditional_field"]').val()&&""!==jQuery(this).find('[id^="_conditional_operator"]').val()||jQuery(i[e]).find(".um-admin-remove-condition").trigger("click")}),i=jQuery(".um-admin-cur-condition"),jQuery(i).each(function(e){e=0===e?"":e;jQuery(this).find('[id^="_conditional_action"]').attr("name","_conditional_action"+e),jQuery(this).find('[id^="_conditional_action"]').attr("id","_conditional_action"+e),jQuery(this).find('[id^="_conditional_field"]').attr("name","_conditional_field"+e),jQuery(this).find('[id^="_conditional_field"]').attr("id","_conditional_field"+e),jQuery(this).find('[id^="_conditional_operator"]').attr("name","_conditional_operator"+e),jQuery(this).find('[id^="_conditional_operator"]').attr("id","_conditional_operator"+e),jQuery(this).find('[id^="_conditional_value"]').attr("name","_conditional_value"+e),jQuery(this).find('[id^="_conditional_value"]').attr("id","_conditional_value"+e)}),jQuery(this));return jQuery.ajax({url:wp.ajax.settings.url,type:"POST",dataType:"json",data:a.serialize(),beforeSend:function(){a.css({opacity:.5}),jQuery(".um-admin-error").removeClass("um-admin-error"),a.find(".um-admin-error-block").hide(),a.find(".um-admin-success-block").hide()},complete:function(){a.css({opacity:1})},success:function(e){if(e.success){var i=e.data;if(i.error){let d=0;jQuery.each(i.error,function(e,i){1===++d&&(a.find("#"+e).addClass("um-admin-error").trigger("focus"),a.find(".um-admin-error-block").show().html(i))}),UM.admin.modal.resize()}else jQuery(".um-col-demon-settings").data("in_row","").data("in_sub_row","").data("in_column","").data("in_group",""),UM.common.tipsy.hide(),UM.admin.modal.remove(),um_admin_update_builder()}else console.log(e)},error:function(e){console.log(e)}}),!1}),jQuery(document.body).on("click",".um-admin-builder a, .um-admin-modal a:not(.um-preview-upload)",function(e){return e.preventDefault(),!1}),jQuery(document.body).on("click",".um-admin-btn-toggle a",function(e){var i=jQuery(this).parent().find(".um-admin-btn-content"),d=jQuery(this);i.is(":hidden")?(i.show(),d.find("i").removeClass().addClass("um-icon-minus"),d.addClass("active")):(i.hide(),d.find("i").removeClass().addClass("um-icon-plus"),d.removeClass("active")),UM.admin.modal.resize()}),jQuery(document.body).on("click",".um-admin-new-condition",function(){if(jQuery(this).hasClass("disabled"))return!1;var e,i=jQuery(this).parents(".um-admin-btn-content"),i=(i.find(".um-admin-cur-condition").length<5?((e=jQuery(".um-admin-btn-content").find(".um-admin-cur-condition-template").clone()).find("input[type=text]").val(""),e.find("select").val(""),e.appendTo(i),jQuery(e).removeClass("um-admin-cur-condition-template"),jQuery(e).addClass("um-admin-cur-condition"),UM.admin.builder.fieldConditions.refresh(),UM.admin.modal.resize()):(jQuery(this).addClass("disabled"),alert("You already have 5 rules")),jQuery(".um-admin-cur-condition"));jQuery(i).each(function(e){id=0===e?"":e,jQuery(this).find('[id^="_conditional_action"]').attr("name","_conditional_action"+id),jQuery(this).find('[id^="_conditional_action"]').attr("id","_conditional_action"+id),jQuery(this).find('[id^="_conditional_field"]').attr("name","_conditional_field"+id),jQuery(this).find('[id^="_conditional_field"]').attr("id","_conditional_field"+id),jQuery(this).find('[id^="_conditional_operator"]').attr("name","_conditional_operator"+id),jQuery(this).find('[id^="_conditional_operator"]').attr("id","_conditional_operator"+id),jQuery(this).find('[id^="_conditional_value"]').attr("name","_conditional_value"+id),jQuery(this).find('[id^="_conditional_value"]').attr("id","_conditional_value"+id)})}),jQuery(document.body).on("click",".um-admin-reset-conditions a",function(){var e=jQuery(this).parents(".um-admin-btn-content");e.find(".um-admin-cur-condition").slice(1).remove(),e.find("input[type=text]").val(""),e.find("select").val(""),jQuery(".um-admin-new-condition").removeClass("disabled"),UM.admin.builder.fieldConditions.refresh(),UM.admin.modal.resize()}),jQuery(document.body).on("click",".um-admin-remove-condition",function(){var e=jQuery(this).parents(".um-admin-cur-condition"),e=(jQuery(".um-admin-new-condition").removeClass("disabled"),UM.common.tipsy.hide(),e.remove(),jQuery(".um-admin-cur-condition"));jQuery(e).each(function(e){id=0===e?"":e,jQuery(this).find('[id^="_conditional_action"]').attr("name","_conditional_action"+id),jQuery(this).find('[id^="_conditional_action"]').attr("id","_conditional_action"+id),jQuery(this).find('[id^="_conditional_field"]').attr("name","_conditional_field"+id),jQuery(this).find('[id^="_conditional_field"]').attr("id","_conditional_field"+id),jQuery(this).find('[id^="_conditional_operator"]').attr("name","_conditional_operator"+id),jQuery(this).find('[id^="_conditional_operator"]').attr("id","_conditional_operator"+id),jQuery(this).find('[id^="_conditional_value"]').attr("name","_conditional_value"+id),jQuery(this).find('[id^="_conditional_value"]').attr("id","_conditional_value"+id)}),UM.admin.builder.fieldConditions.refresh(),UM.admin.modal.resize()}),jQuery(document.body).on("blur","#_custom_dropdown_options_source",function(){var e=jQuery(this),a=jQuery("textarea[id=_options]");""!==e.val()?(e=e.val(),jQuery.ajax({url:wp.ajax.settings.url,type:"POST",data:{action:"um_populate_dropdown_options",um_option_callback:e,nonce:um_admin_scripts.nonce},complete:function(){},success:function(e){var i,d=[];for(i in e.data)d.push(e.data[i]);a.val(d.join("\n"))}}),jQuery("#_parent_dropdown_relationship").parents("p").show()):jQuery("#_parent_dropdown_relationship").parents("p").hide()}),!jQuery(".um-admin-drag").length)return!1;UM_Drag_and_Drop(),jQuery(document.body).on("click","a.um-admin-drag-add-field",function(){in_row=jQuery(this).parents(".um-admin-drag-row").index(),in_sub_row=jQuery(this).parents(".um-admin-drag-rowsub").index(),in_column=1==jQuery(this).parents(".um-admin-drag-rowsub").find(".um-admin-drag-col").length?1:jQuery(this).parents(".um-admin-drag-col").hasClass("cols-middle")?2:jQuery(this).parents(".um-admin-drag-col").hasClass("cols-last")?3==jQuery(this).parents(".um-admin-drag-rowsub").find(".um-admin-drag-col").length?3:2:1,in_group=jQuery(this).parents(".um-admin-drag-group").length?jQuery(this).parents(".um-admin-drag-fld.um-field-type-group").data("key"):"",jQuery(".um-col-demon-settings").data("in_row",in_row),jQuery(".um-col-demon-settings").data("in_sub_row",in_sub_row),jQuery(".um-col-demon-settings").data("in_column",in_column),jQuery(".um-col-demon-settings").data("in_group",in_group)}),jQuery(document.body).on("click",'*[data-row_action="add_row"]',function(){var e=jQuery(".um-admin-drag-ajax");e.append('<div class="um-admin-drag-row">'+jQuery(".um-col-demon-row").html()+"</div>"),e.find(".um-admin-drag-row:last").find(".um-admin-drag-row-icons").find("a.um-admin-drag-row-edit").attr("data-arg3","_um_row_"+e.find(".um-admin-drag-row").length),e.find(".um-admin-drag-row:last").attr("data-original","_um_row_"+e.find(".um-admin-drag-row").length),UM_update_rows(),UM_update_subrows(),UM_Rows_Refresh()}),jQuery(document.body).on("click",'*[data-row_action="add_subrow"]',function(){jQuery(this).parents(".um-admin-drag-row").find(".um-admin-drag-rowsubs").append('<div class="um-admin-drag-rowsub">'+jQuery(".um-col-demon-subrow").html()+"</div>"),UM_update_subrows(),UM_Rows_Refresh()}),jQuery(document.body).on("click",'a[data-remove_element^="um-"]',function(){let e=jQuery(this),i=jQuery(this).data("remove_element"),d=jQuery(this).parents("."+i).children(".um-admin-row-loading");var a=jQuery(this).parents(".um-admin-drag-row").index(),n=jQuery(this).parents(".um-admin-drag-rowsub").index();let r={row:a,subrow:n},o=!1;jQuery.each(UM.admin.builder.deleteProcess,function(e){if(r.row===UM.admin.builder.deleteProcess[e].row&&r.subrow===UM.admin.builder.deleteProcess[e].subrow)return!(o=!0)}),o||(d.show(),UM.admin.builder.deleteProcess.push({row:a,subrow:n}),UM.admin.builder.fieldsToDelete=jQuery(this).parents("."+i).find(".um-admin-drag-fld").toArray(),0<UM.admin.builder.fieldsToDelete.length?um_builder_delete_field_ajax(function(){UM.common.tipsy.hide(),e.parents("."+i).remove(),UM_Rows_Refresh(),jQuery.each(UM.admin.builder.deleteProcess,function(e){if(r.row===UM.admin.builder.deleteProcess[e].row&&r.subrow===UM.admin.builder.deleteProcess[e].subrow)return UM.admin.builder.deleteProcess.splice(e,1),!1}),d.hide()}):(UM.common.tipsy.hide(),jQuery(this).parents("."+i).remove(),UM_Rows_Refresh(),jQuery.each(UM.admin.builder.deleteProcess,function(e){if(r.row===UM.admin.builder.deleteProcess[e].row&&r.subrow===UM.admin.builder.deleteProcess[e].subrow)return UM.admin.builder.deleteProcess.splice(e,1),!1}),d.hide()))}),jQuery(document.body).on("click",".um-admin-drag-ctrls.columns a",function(){var e=jQuery(this).parents(".um-admin-drag-rowsub"),d=jQuery(this),a=(jQuery(this).parent().find("a").removeClass("active"),d.addClass("active"),e.find(".um-admin-drag-col").length),n=d.data("cols")-a;if(0<n){for(i=0;i<n;i++)e.find(".um-admin-drag-col-dynamic").append('<div class="um-admin-drag-col"></div>');e.find(".um-admin-drag-col").removeClass("cols-1 cols-2 cols-3 cols-last cols-middle"),e.find(".um-admin-drag-col").addClass("cols-"+e.find(".um-admin-drag-col").length),e.find(".um-admin-drag-col:last").addClass("cols-last"),3==e.find(".um-admin-drag-col").length&&e.find(".um-admin-drag-col:eq(1)").addClass("cols-middle")}else n<0&&(2==(n+=3)&&(e.find(".um-admin-drag-col:first").append(e.find(".um-admin-drag-col.cols-last").html()),e.find(".um-admin-drag-col.cols-last").remove()),1==n&&(e.find(".um-admin-drag-col:first").append(e.find(".um-admin-drag-col.cols-last").html()),e.find(".um-admin-drag-col:first").append(e.find(".um-admin-drag-col.cols-middle").html()),e.find(".um-admin-drag-col.cols-last").remove(),e.find(".um-admin-drag-col.cols-middle").remove()),e.find(".um-admin-drag-col").removeClass("cols-1 cols-2 cols-3 cols-last cols-middle"),e.find(".um-admin-drag-col").addClass("cols-"+e.find(".um-admin-drag-col:visible").length),e.find(".um-admin-drag-col:last").addClass("cols-last"));1==allow_update_via_col_click&&(UM_Change_Field_Col(),UM_Rows_Refresh())}),allow_update_via_col_click=!1,jQuery(".um-admin-drag-ctrls.columns a.active").each(function(){jQuery(this).trigger("click")}).promise().done(function(){allow_update_via_col_click=!0}),UM_Rows_Refresh()});