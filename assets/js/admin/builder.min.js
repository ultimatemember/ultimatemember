var $um_tiny_editor;function UM_Drag_and_Drop(){jQuery(".um-admin-drag-col,.um-admin-drag-group").sortable({items:".um-admin-drag-fld",connectWith:".um-admin-drag-col,.um-admin-drag-group",placeholder:"um-fld-placeholder",forcePlaceholderSize:!0,update:function(e,i){jQuery("#publish").attr("disabled","disabled"),i.item.hasClass("um-field-type-group")&&0<i.item.parents(".um-field-type-group").length?(jQuery(".um-admin-drag-col,.um-admin-drag-group").sortable("cancel"),jQuery("#publish").prop("disabled",!1)):(UM_Change_Field_Col(),UM_Change_Field_Grp(),UM_Rows_Refresh())}}),jQuery(".um-admin-drag-rowsubs").sortable({items:".um-admin-drag-rowsub",placeholder:"um-rowsub-placeholder",forcePlaceholderSize:!0,zIndex:9999999999,update:function(){jQuery("#publish").attr("disabled","disabled"),UM_update_subrows(),UM_Rows_Refresh()}}).disableSelection(),jQuery(".um-admin-drag-rowsub").sortable({items:".um-admin-drag-col",zIndex:9999999999,update:function(){jQuery("#publish").attr("disabled","disabled"),row=jQuery(this),row.find(".um-admin-drag-col").removeClass("cols-1 cols-2 cols-3 cols-last cols-middle"),row.find(".um-admin-drag-col").addClass("cols-"+row.find(".um-admin-drag-col").length),row.find(".um-admin-drag-col:last").addClass("cols-last"),3==row.find(".um-admin-drag-col").length&&row.find(".um-admin-drag-col:eq(1)").addClass("cols-middle"),UM_Change_Field_Col(),UM_Change_Field_Grp(),UM_Rows_Refresh()}}).disableSelection(),jQuery(".um-admin-drag-ajax").sortable({items:".um-admin-drag-row",handle:".um-admin-drag-row-start",zIndex:9999999999,placeholder:"um-row-placeholder",forcePlaceholderSize:!0,out:function(){jQuery(".tipsy").remove()},update:function(){jQuery("#publish").attr("disabled","disabled"),UM_update_rows(),UM_Change_Field_Col(),UM_Change_Field_Grp(),UM_Rows_Refresh()}}).disableSelection()}function UM_update_rows(){var e=0;jQuery('a[data-remove_element="um-admin-drag-row"]').remove(),jQuery(".um-admin-drag-row").each(function(){e++,row=jQuery(this),1!=e&&row.find(".um-admin-drag-row-icons").append('<a href="#" class="um-admin-tipsy-n" title="'+wp.i18n.__("Delete Row","ultimate-member")+'" data-remove_element="um-admin-drag-row"><i class="far fa-trash-alt"></i></a>')})}function UM_update_subrows(){jQuery('a[data-remove_element="um-admin-drag-rowsub"]').remove(),jQuery(".um-admin-drag-row").each(function(){c=0,jQuery(this).find(".um-admin-drag-rowsub").each(function(){c++,row=jQuery(this),1!=c&&row.find(".um-admin-drag-rowsub-icons").append('<a href="#" class="um-admin-tipsy-n" title="'+wp.i18n.__("Delete Row","ultimate-member")+'" data-remove_element="um-admin-drag-rowsub"><i class="far fa-trash-alt"></i></a>')})})}function UM_Change_Field_Col(){jQuery(".um-admin-drag-col .um-admin-drag-fld").each(function(){cols=jQuery(this).parents(".um-admin-drag-rowsub").find(".um-admin-drag-col").length,col=jQuery(this).parents(".um-admin-drag-col"),col.hasClass("cols-last")?(1==cols&&(saved_col=1),3==cols?saved_col=3:2==cols&&(saved_col=2)):saved_col=col.hasClass("cols-middle")&&3==cols?2:1,jQuery(this).data("column",saved_col)})}function UM_Change_Field_Grp(){jQuery(".um-admin-drag-col .um-admin-drag-fld:not(.um-field-type-group)").each(function(){0==jQuery(this).parents(".um-admin-drag-group").length?jQuery(this).data("group",""):jQuery(this).data("group",jQuery(this).parents(".um-admin-drag-fld.um-field-type-group").data("key"))})}function UM_Rows_Refresh(){jQuery(".um_update_order_fields").empty();var i,d=0;jQuery(".um-admin-drag-row").each(function(){d++,row=jQuery(this),col_num="",row.find(".um-admin-drag-rowsub").each(function(){subrow=jQuery(this),subrow.find(".um-admin-drag-col").removeClass("cols-1 cols-2 cols-3 cols-last cols-middle"),subrow.find(".um-admin-drag-col").addClass("cols-"+subrow.find(".um-admin-drag-col").length),subrow.find(".um-admin-drag-col:last").addClass("cols-last"),3==subrow.find(".um-admin-drag-col").length&&subrow.find(".um-admin-drag-col:eq(1)").addClass("cols-middle"),col_num=col_num?col_num+":"+subrow.find(".um-admin-drag-col").length:subrow.find(".um-admin-drag-col").length}),jQuery(".um_update_order_fields").append('<input type="hidden" name="_um_rowcols_'+d+'_cols" id="_um_rowcols_'+d+'_cols" value="'+col_num+'" />'),sub_rows_count=row.find(".um-admin-drag-rowsub").length;var e=jQuery(this).attr("data-original");jQuery(".um_update_order_fields").append('<input type="hidden" name="_um_row_'+d+'" id="_um_row_'+d+'" value="_um_row_'+d+'" />'),jQuery(".um_update_order_fields").append('<input type="hidden" name="_um_roworigin_'+d+'_val" id="_um_roworigin_'+d+'_val" value="'+e+'" />'),jQuery(".um_update_order_fields").append('<input type="hidden" name="_um_rowsub_'+d+'_rows" id="_um_rowsub_'+d+'_rows" value="'+sub_rows_count+'" />'),jQuery(this).attr("data-original","_um_row_"+d)}),i=0,jQuery(".um-admin-drag-col .um-admin-drag-fld").each(function(){var e;jQuery(this).hasClass("group")||(""!=(e=jQuery(this).data("group"))?(0==jQuery(".um-admin-drag-fld.um-field-type-group."+e).find(".um-admin-drag-group").find(jQuery(this)).length&&jQuery(this).appendTo(jQuery(".um-admin-drag-fld.um-field-type-group."+e).find(".um-admin-drag-group")),jQuery(".um_update_order_fields").append('<input type="hidden" name="um_group_'+jQuery(this).data("key")+'" id="um_group_'+jQuery(this).data("key")+'" value="'+e+'" />')):jQuery(".um_update_order_fields").append('<input type="hidden" name="um_group_'+jQuery(this).data("key")+'" id="um_group_'+jQuery(this).data("key")+'" value="" />')),i++,row=jQuery(this).parents(".um-admin-drag-row").index()+1,row="_um_row_"+row,saved_col=jQuery(this).data("column"),3==saved_col&&jQuery(this).appendTo(jQuery(this).parents(".um-admin-drag-rowsub").find(".um-admin-drag-col:eq(2)")),2==saved_col&&jQuery(this).appendTo(jQuery(this).parents(".um-admin-drag-rowsub").find(".um-admin-drag-col:eq(1)")),sub_row=jQuery(this).parents(".um-admin-drag-rowsub").index(),jQuery(".um_update_order_fields").append('<input type="hidden" name="um_position_'+jQuery(this).data("key")+'" id="um_position_'+jQuery(this).data("key")+'" value="'+i+'" />'),jQuery(".um_update_order_fields").append('<input type="hidden" name="um_row_'+jQuery(this).data("key")+'" id="um_row_'+jQuery(this).data("key")+'" value="'+row+'" />'),jQuery(".um_update_order_fields").append('<input type="hidden" name="um_subrow_'+jQuery(this).data("key")+'" id="um_subrow_'+jQuery(this).data("key")+'" value="'+sub_row+'" />'),jQuery(".um_update_order_fields").append('<input type="hidden" name="um_col_'+jQuery(this).data("key")+'" id="um_col_'+jQuery(this).data("key")+'" value="'+saved_col+'" />')}),UM_Drag_and_Drop(),UM_Add_Icon(),jQuery.ajax({url:wp.ajax.settings.url,type:"POST",data:jQuery(".um_update_order").serialize(),success:function(){jQuery("#publish").prop("disabled",!1)}}),jQuery(".um_admin_edit_field_popup.um-admin-drag-row-edit").umModal({header:wp.i18n.__("Edit Row Settings","ultimate-member"),size:"large",classes:"um-admin-modal um-admin-fields-form",content:function(e,i){let d=this,a=i.relatedButton;wp.ajax.send("um_admin_edit_field_popup",{data:{field_type:a.data("field_type"),form_id:a.data("form_id"),field_key:a.data("field_key"),nonce:um_admin_scripts.nonce},beforeSend:function(){d.addClass("loading")},success:function(e){d.removeClass("loading"),d.find(".um-modal-body").html(e),um_trigger_callback_dropdown(d),um_trigger_conditional_fields(d),um_init_helptips(),um_admin_init_icon_select(),um_admin_init_colorpicker(),um_maybe_init_tinymce(d,"edit"),um_admin_init_datetimepicker(),UM.modal.responsive(d)},error:function(e){d.removeClass("loading"),console.error(e)}})}}),jQuery(".um_admin_edit_field_popup:not(.um-admin-drag-row-edit)").umModal({header:wp.i18n.__("Edit Field","ultimate-member"),size:"large",classes:"um-admin-modal um-admin-fields-form",content:function(e,i){let d=this,a=i.relatedButton;wp.ajax.send("um_admin_edit_field_popup",{data:{field_type:a.data("field_type"),form_id:a.data("form_id"),field_key:a.data("field_key"),nonce:um_admin_scripts.nonce},beforeSend:function(){d.addClass("loading")},success:function(e){d.removeClass("loading"),d.find(".um-modal-body").html(e),um_trigger_callback_dropdown(d),um_trigger_conditional_fields(d),um_init_helptips(),um_admin_init_icon_select(),um_admin_init_colorpicker(),um_maybe_init_tinymce(d,"edit"),um_admin_init_datetimepicker(),UM.modal.responsive(d)},error:function(e){d.removeClass("loading"),console.error(e)}})}})}function um_trigger_callback_dropdown(e){e.find("#_custom_dropdown_options_source").trigger("blur")}function um_trigger_conditional_fields(e){e.find(".um-adm-conditional").each(function(){jQuery(this).trigger("change")})}function um_maybe_init_tinymce(e,i){e.find(".um-admin-editor").length&&"function"==typeof um_tinymce_init&&um_tinymce_init("edit"===i?"um_editor_edit":"um_editor_new","edit"===i?e.find(".dynamic-mce-content").html():"")}function um_tinymce_init(i,e){var d,a=jQuery("#"+i);"object"==typeof tinyMCE&&null!==tinyMCE.get(i)?(tinyMCE.triggerSave(),tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,i),"4"===tinyMCE.majorVersion?window.tinyMCE.execCommand("mceRemoveEditor",!0,i):window.tinyMCE.execCommand("mceRemoveControl",!0,i),$um_tiny_editor=jQuery("<div>").append(a.parents("#wp-"+i+"-wrap").clone()),a.parents("#wp-"+i+"-wrap").replaceWith('<div class="um_tiny_placeholder"></div>'),jQuery(".um-admin-editor:visible").html(jQuery($um_tiny_editor).html()),d=void 0===tinyMCEPreInit.mceInit[i]?tinyMCEPreInit.mceInit[i]=tinyMCE.extend({},tinyMCEPreInit.mceInit[i]):tinyMCEPreInit.mceInit[i],"function"==typeof QTags&&(QTags(tinyMCEPreInit.qtInit[i]),QTags._buttonsInit()),"object"==typeof window.switchEditors&&window.switchEditors.go(i),tinyMCE.init(d),tinyMCE.get(i).setContent(e),a.html(e)):($um_tiny_editor=jQuery("<div>").append(a.parents("#wp-"+i+"-wrap").clone()),a.parents("#wp-"+i+"-wrap").replaceWith('<div class="um_tiny_placeholder"></div>'),jQuery(".um-admin-editor:visible").html(jQuery($um_tiny_editor).html()),"function"==typeof QTags&&(QTags(tinyMCEPreInit.qtInit[i]),QTags._buttonsInit()),jQuery("#"+i).html(e)),jQuery("body").on("click",".wp-switch-editor",function(){var e=jQuery(this);e.hasClass("wp-switch-editor")&&"object"==typeof window.switchEditors&&(e=e.hasClass("switch-tmce")?"tmce":"html",window.switchEditors.go(i,e))})}function UM_Add_Icon(){var e='<a href="#" class="um-admin-drag-add-field um-admin-tipsy-n" title="'+wp.i18n.__("Add Field","ultimate-member")+'" data-form_id="'+jQuery(".um-admin-drag-ajax").data("form_id")+'"><i class="fas fa-plus"></i></a>';jQuery(".um-admin-drag-col").each(function(){0===jQuery(this).find(".um-admin-drag-add-field").length||jQuery(this).find(".um-admin-drag-add-field").remove(),jQuery(this).append(e)}),jQuery(".um-admin-drag-group").each(function(){0===jQuery(this).find(".um-admin-drag-add-field").length||jQuery(this).find(".um-admin-drag-add-field").remove(),jQuery(this).append(e)}),um_admin_init_tipsy(),jQuery(".um-admin-drag-add-field").umModal({header:wp.i18n.__("Fields Manager","ultimate-member"),content:function(e,i){let d=this,a=i.relatedButton;wp.ajax.send("um_admin_fields_list",{data:{form_id:a.data("form_id"),nonce:um_admin_scripts.nonce},beforeSend:function(){d.addClass("loading")},success:function(e){if(d.removeClass("loading"),d.find(".um-modal-body").html(e),UM.modal.responsive(d),jQuery(".um_admin_new_field_popup").length){let e=jQuery(".um-admin-builder");var n=e.data("in_row"),o=e.data("in_sub_row"),r=e.data("in_column"),t=e.data("in_group");jQuery(".um_admin_new_field_popup").umModal({header:wp.i18n.__("Add a New Field","ultimate-member"),size:"large",classes:"um-admin-modal um-admin-fields-form",content:function(e,i){let d=this,a=i.relatedButton;wp.ajax.send("um_admin_new_field_popup",{data:{field_type:a.data("field_type"),form_id:a.data("form_id"),in_row:n,in_sub_row:o,in_column:r,in_group:t,nonce:um_admin_scripts.nonce},beforeSend:function(){d.addClass("loading")},success:function(e){d.removeClass("loading"),d.find(".um-modal-body").html(e),um_trigger_callback_dropdown(d),um_trigger_conditional_fields(d),um_init_helptips(),um_admin_init_icon_select(),um_admin_init_colorpicker(),um_maybe_init_tinymce(d,"add"),um_admin_init_datetimepicker(),UM.modal.responsive(d)},error:function(e){d.removeClass("loading"),console.error(e)}})}})}},error:function(e){d.removeClass("loading"),console.error(e)}})}})}function um_admin_modal_button_clicked(d,e){let a=d.relatedButton;if(a.hasClass("um-admin-drag-add-field")){var n=a.parents(".um-admin-drag-row").index(),d=a.parents(".um-admin-drag-rowsub").index();let e=1;1<a.parents(".um-admin-drag-rowsub").find(".um-admin-drag-col").length&&(a.parents(".um-admin-drag-col").hasClass("cols-middle")?e=2:a.parents(".um-admin-drag-col").hasClass("cols-last")&&(e=3===a.parents(".um-admin-drag-rowsub").find(".um-admin-drag-col").length?3:2));let i="";a.parents(".um-admin-drag-group").length&&(i=a.parents(".um-admin-drag-fld.um-field-type-group").data("key")),jQuery(".um-admin-builder").data("in_row",n).data("in_sub_row",d).data("in_column",e).data("in_group",i)}}function um_admin_modal_before_close(e){e.find(".um-admin-editor").length&&(tinyMCE.triggerSave(),e=e.find(".um_edit_field").length?"um_editor_edit":"um_editor_new",jQuery("#wp-"+e+"-wrap").remove(),jQuery(".um_tiny_placeholder").replaceWith(jQuery($um_tiny_editor).html()))}function um_form_select_tab(e,i){var d=jQuery("input#form__um_mode");e.parents(".um-admin-boxed-links").find("a").removeClass("um-admin-activebg"),e.addClass("um-admin-activebg"),jQuery(".um-admin div#side-sortables").show(),jQuery('div[id^="um-admin-form"]').hide(),jQuery("#submitdiv").show(),jQuery("div#um-admin-form-mode,div#um-admin-form-title,div#um-admin-form-builder,div#um-admin-form-shortcode").show(),jQuery('div[id^="um-admin-form-'+e.data("role")+'"]').show(),i&&d.val(e.data("role")),jQuery(".empty-container").css({border:"none"}),jQuery(".um-admin-builder").removeClass().addClass("um-admin-builder "+d.val())}function um_admin_update_builder(){var e=jQuery(".um-admin-builder").data("form_id");return jQuery(".tipsy").hide(),jQuery.ajax({url:wp.ajax.settings.url,type:"POST",data:{action:"um_update_builder",form_id:e,nonce:um_admin_scripts.nonce},success:function(e){jQuery(".um-admin-drag-ajax").html(e),jQuery(".tipsy").hide(),allow_update_via_col_click=!1,jQuery(".um-admin-drag-ctrls.columns a.active").each(function(){jQuery(this).trigger("click")}).promise().done(function(){allow_update_via_col_click=!0}),UM_Rows_Refresh()},error:function(e){}}),!1}wp.hooks.addAction("um-modal-button-clicked","ultimatemember",um_admin_modal_button_clicked,10,2),wp.hooks.addAction("um-modal-before-close","ultimatemember",um_admin_modal_before_close,10,1),jQuery(document).ready(function(){jQuery("#wpfooter").hide(),0<jQuery(".um-admin-boxed-links").length&&um_form_select_tab(jQuery('.um-admin-boxed-links a[data-role="'+jQuery("input#form__um_mode").val()+'"]'),!1),jQuery(".um-admin-boxed-links:not(.is-core-form) a").on("click",function(){um_form_select_tab(jQuery(this),!0)}),jQuery(".um-admin-ajaxlink").on("click",function(e){return e.preventDefault(),!1}),jQuery(document.body).on("click",".um-modal-tab a",function(){var e,i;jQuery(this).parents("li").hasClass("active")||(jQuery(this).parents(".um-modal-tabs").find(".um-modal-tab").removeClass("active"),jQuery(this).parents("li").addClass("active"),e=jQuery(this).data("key"),(i=jQuery(".um-modal-tabs-content-wrapper")).find(".um-modal-tab-content").removeClass("active"),i.find(".um-modal-tab-"+e).addClass("active"))}),jQuery(".um_admin_preview_form").umModal({header:wp.i18n.__("Live Form Preview","ultimate-member"),size:"small",classes:"um-admin-form-preview",content:function(e,i){let d=this,a=i.relatedButton;wp.ajax.send("um_admin_preview_form",{data:{form_id:a.data("form_id"),nonce:um_admin_scripts.nonce},beforeSend:function(){d.addClass("loading")},success:function(e){d.removeClass("loading"),d.find(".um-modal-body").html(e),um_responsive(),jQuery(".um-admin-preview-overlay").css("height",+jQuery(".um-admin-preview-overlay").siblings(".um").outerHeight(!0)+20+"px"),UM.modal.responsive(d)},error:function(e){d.removeClass("loading"),console.error(e)}})}}),jQuery(document.body).on("click",".um-admin-builder a, .um-admin-modal a",function(e){return e.preventDefault(),!1}),jQuery(document.body).on("blur","#_custom_dropdown_options_source",function(){var e=jQuery(this).val(),a=jQuery("textarea[id=_options]");""!==e&&jQuery.ajax({url:wp.ajax.settings.url,type:"POST",data:{action:"um_populate_dropdown_options",um_option_callback:e,nonce:um_admin_scripts.nonce},complete:function(){},success:function(e){var i,d=[];for(i in e.data)d.push(e.data[i]);a.val(d.join("\n"))}})}),jQuery(document.body).on("change",".um-adm-conditional",function(){var e="checkbox"==jQuery(this).attr("type")?jQuery(this).is(":checked")?1:0:jQuery(this).val();if(jQuery(this).data("cond1"))if(e==jQuery(this).data("cond1")){if(jQuery("."+jQuery(this).data("cond1-show")).show(),jQuery("."+jQuery(this).data("cond1-hide")).hide(),"_roles"==jQuery(this).data("cond1-show"))return!1}else jQuery("."+jQuery(this).data("cond1-show")).hide(),jQuery("."+jQuery(this).data("cond1-hide")).show();if(jQuery(this).data("cond2"))if(e==jQuery(this).data("cond2")){if(jQuery("."+jQuery(this).data("cond2-show")).show(),jQuery("."+jQuery(this).data("cond2-hide")).hide(),"_roles"==jQuery(this).data("cond2-show"))return!1}else jQuery("."+jQuery(this).data("cond2-show")).hide(),jQuery("."+jQuery(this).data("cond2-hide")).show();jQuery(this).data("cond3")&&(e==jQuery(this).data("cond3")?(jQuery("."+jQuery(this).data("cond3-show")).show(),jQuery("."+jQuery(this).data("cond3-hide")).hide()):(jQuery("."+jQuery(this).data("cond3-show")).hide(),jQuery("."+jQuery(this).data("cond3-hide")).show()))}),jQuery(".um-admin-drag").length&&(UM_Drag_and_Drop(),jQuery(document.body).on("click",'*[data-row_action="add_row"]',function(){var e=jQuery(".um-admin-drag-ajax");e.append('<div class="um-admin-drag-row">'+jQuery(".um-col-demon-row").html()+"</div>"),e.find(".um-admin-drag-row:last").find(".um-admin-drag-row-icons").find("a.um-admin-drag-row-edit").attr("data-field_key","_um_row_"+e.find(".um-admin-drag-row").length),e.find(".um-admin-drag-row:last").attr("data-original","_um_row_"+e.find(".um-admin-drag-row").length),UM_update_rows(),UM_update_subrows(),UM_Rows_Refresh()}),jQuery(document.body).on("click",'*[data-row_action="add_subrow"]',function(){jQuery(this).parents(".um-admin-drag-row").find(".um-admin-drag-rowsubs").append('<div class="um-admin-drag-rowsub">'+jQuery(".um-col-demon-subrow").html()+"</div>"),UM_update_subrows(),UM_Rows_Refresh()}),jQuery(document.body).on("click",".um-admin-drag-ctrls.columns a",function(){var e=jQuery(this).parents(".um-admin-drag-rowsub"),d=jQuery(this);jQuery(this).parent().find("a").removeClass("active"),d.addClass("active");var a=e.find(".um-admin-drag-col").length,n=d.data("cols")-a;if(0<n){for(i=0;i<n;i++)e.find(".um-admin-drag-col-dynamic").append('<div class="um-admin-drag-col"></div>');e.find(".um-admin-drag-col").removeClass("cols-1 cols-2 cols-3 cols-last cols-middle"),e.find(".um-admin-drag-col").addClass("cols-"+e.find(".um-admin-drag-col").length),e.find(".um-admin-drag-col:last").addClass("cols-last"),3==e.find(".um-admin-drag-col").length&&e.find(".um-admin-drag-col:eq(1)").addClass("cols-middle")}else n<0&&(2==(n+=3)&&(e.find(".um-admin-drag-col:first").append(e.find(".um-admin-drag-col.cols-last").html()),e.find(".um-admin-drag-col.cols-last").remove()),1==n&&(e.find(".um-admin-drag-col:first").append(e.find(".um-admin-drag-col.cols-last").html()),e.find(".um-admin-drag-col:first").append(e.find(".um-admin-drag-col.cols-middle").html()),e.find(".um-admin-drag-col.cols-last").remove(),e.find(".um-admin-drag-col.cols-middle").remove()),e.find(".um-admin-drag-col").removeClass("cols-1 cols-2 cols-3 cols-last cols-middle"),e.find(".um-admin-drag-col").addClass("cols-"+e.find(".um-admin-drag-col:visible").length),e.find(".um-admin-drag-col:last").addClass("cols-last"));1==allow_update_via_col_click&&(UM_Change_Field_Col(),UM_Rows_Refresh())}),allow_update_via_col_click=!1,jQuery(".um-admin-drag-ctrls.columns a.active").each(function(){jQuery(this).trigger("click")}).promise().done(function(){allow_update_via_col_click=!0}),UM_Rows_Refresh()),jQuery(document.body).on("click",".um-admin-btns a span.remove",function(e){var i,d,a;return e.preventDefault(),confirm(wp.i18n.__("This will permanently delete this custom field from a database and from all forms on your site. Are you sure?","ultimate-member"))&&(i=jQuery(this).parents("a"),d=i.data("field_key"),a=jQuery(this).parents(".um-admin-btns"),wp.ajax.send("um_admin_remove_field_global",{data:{field_key:d,nonce:um_admin_scripts.nonce},success:function(e){jQuery("#um-admin-form-builder ."+d).remove(),i.remove(),a.find("a").length||jQuery(".um-no-custom-fields").show()},error:function(e){console.log(e)}})),!1}),jQuery(document.body).on("click",".um_admin_duplicate_field",function(e){e.preventDefault();var i=jQuery(this).data("form_id"),e=jQuery(this).data("field_key");return wp.ajax.send("um_admin_duplicate_field",{data:{field_key:e,form_id:i,nonce:um_admin_scripts.nonce},success:function(e){um_admin_update_builder()},error:function(e){console.log(e)}}),!1}),jQuery(document.body).on("click",".um_admin_remove_field",function(e){e.preventDefault();var i=jQuery(this).data("form_id"),e=jQuery(this).data("field_key");return wp.ajax.send("um_admin_remove_field",{data:{field_key:e,form_id:i,nonce:um_admin_scripts.nonce},success:function(e){um_admin_update_builder(),UM_Rows_Refresh()},error:function(e){console.log(e)}}),!1}),jQuery(document.body).on("click",'a[data-remove_element^="um-"]',function(){var e=jQuery(this).data("remove_element");jQuery(this).parents("."+e).find(".um-admin-drag-fld").each(function(){jQuery(this).find("a.um_admin_remove_field").trigger("click")}),jQuery(this).parents("."+e).remove(),jQuery(".tipsy").remove(),UM_Rows_Refresh()}),jQuery(document.body).on("click",".um_admin_add_field_from_list",function(){if(void 0!==jQuery(this).attr("disabled"))return!1;let i=jQuery(".um-admin-builder");jQuery(".tipsy").hide();var e=i.data("in_row"),d=i.data("in_sub_row"),a=i.data("in_column"),n=i.data("in_group"),o=jQuery(this).data("field_key"),r=jQuery(this).data("form_id");return wp.ajax.send("um_admin_add_field_from_list",{data:{field_key:o,form_id:r,in_row:e,in_sub_row:d,in_column:a,in_group:n,nonce:um_admin_scripts.nonce},success:function(e){i.data("in_row","").data("in_sub_row","").data("in_column","").data("in_group",""),um_admin_update_builder(),UM.modal.close()},error:function(e){console.log(e)}}),!1}),jQuery(document.body).on("click",".um_admin_add_field_from_predefined",function(){if(void 0!==jQuery(this).attr("disabled"))return!1;let i=jQuery(".um-admin-builder");jQuery(".tipsy").hide();var e=i.data("in_row"),d=i.data("in_sub_row"),a=i.data("in_column"),n=i.data("in_group"),o=jQuery(this).data("field_key"),r=jQuery(this).data("form_id");return wp.ajax.send("um_admin_add_field_from_predefined",{data:{field_key:o,form_id:r,in_row:e,in_sub_row:d,in_column:a,in_group:n,nonce:um_admin_scripts.nonce},success:function(e){i.data("in_row","").data("in_sub_row","").data("in_column","").data("in_group",""),um_admin_update_builder(),UM.modal.close()},error:function(e){console.log(e)}}),!1}),jQuery(document.body).on("submit","form.um_add_field",function(e){e.preventDefault();var i=jQuery(".um-admin-cur-condition");jQuery(i).each(function(e){""!==jQuery(this).find('[id^="_conditional_action"]').val()&&""!==jQuery(this).find('[id^="_conditional_field"]').val()&&""!==jQuery(this).find('[id^="_conditional_operator"]').val()||jQuery(i[e]).find(".um-admin-remove-condition").trigger("click")}),i=jQuery(".um-admin-cur-condition"),jQuery(i).each(function(e){e=0===e?"":e;jQuery(this).find('[id^="_conditional_action"]').attr("name","_conditional_action"+e),jQuery(this).find('[id^="_conditional_action"]').attr("id","_conditional_action"+e),jQuery(this).find('[id^="_conditional_field"]').attr("name","_conditional_field"+e),jQuery(this).find('[id^="_conditional_field"]').attr("id","_conditional_field"+e),jQuery(this).find('[id^="_conditional_operator"]').attr("name","_conditional_operator"+e),jQuery(this).find('[id^="_conditional_operator"]').attr("id","_conditional_operator"+e),jQuery(this).find('[id^="_conditional_value"]').attr("name","_conditional_value"+e),jQuery(this).find('[id^="_conditional_value"]').attr("id","_conditional_value"+e)});var d=jQuery(this);return jQuery.ajax({url:wp.ajax.settings.url,type:"POST",dataType:"json",data:d.serialize(),beforeSend:function(){d.css({opacity:.5}),jQuery(".um-admin-error").removeClass("um-admin-error"),d.find(".um-admin-error-block").hide(),d.find(".um-admin-success-block").hide()},complete:function(){d.css({opacity:1})},success:function(e){e.error?(c=0,jQuery.each(e.error,function(e,i){c++,1==c&&(d.find("#"+e).addClass("um-admin-error").trigger("focus"),d.find(".um-admin-error-block").show().html(i))}),UM.modal.responsive()):(jQuery(".um-admin-builder").data("in_row","").data("in_sub_row","").data("in_column","").data("in_group",""),UM.modal.closeAll(),um_admin_update_builder())},error:function(e){console.log(e)}}),!1}),jQuery(document.body).on("click",".um-admin-modal-close",function(e){e.preventDefault(),UM.modal.close()}),jQuery(document.body).on("click",".um-admin-btn-toggle > a",function(e){e.preventDefault();var i=jQuery(e.currentTarget),e=i.closest(".um-admin-btn-toggle").find(".um-admin-btn-content");e.is(":hidden")?(e.show(),i.addClass("active").find("i").removeClass("fas fa-plus").addClass("fas fa-minus")):(e.hide(),i.removeClass("active").find("i").removeClass("fas fa-minus").addClass("fas fa-plus")),UM.modal.responsive()}),jQuery(document.body).on("click",".um-admin-new-condition:not(.disabled)",function(e){e.preventDefault();var i=jQuery(this).parents(".um-admin-btn-content"),d=i.find(".um-admin-cur-condition").length;if(d<5){e=jQuery(".um-admin-btn-content").find(".um-admin-cur-condition-template").clone();if(0<d){for(var a=1;a<5;a++)if(i.find('[id="_conditional_action'+a+'"]').length<1){var n=a;break}e.find('[id^="_conditional_action"]').attr("name","_conditional_action"+n),e.find('[id^="_conditional_action"]').attr("id","_conditional_action"+n),e.find('[id^="_conditional_field"]').attr("name","_conditional_field"+n),e.find('[id^="_conditional_field"]').attr("id","_conditional_field"+n),e.find('[id^="_conditional_operator"]').attr("name","_conditional_operator"+n),e.find('[id^="_conditional_operator"]').attr("id","_conditional_operator"+n),e.find('[id^="_conditional_value"]').attr("name","_conditional_value"+n),e.find('[id^="_conditional_value"]').attr("id","_conditional_value"+n)}e.find("input[type=text], select").val(""),e.removeClass("um-admin-cur-condition-template").addClass("um-admin-cur-condition").appendTo(i),UM.modal.responsive()}else jQuery(this).addClass("disabled"),alert(wp.i18n.__("You already have 5 rules","ultimate-member"))}),jQuery(document.body).on("click",".um-admin-reset-conditions a",function(e){e.preventDefault();e=jQuery(this).parents(".um-admin-btn-content");e.find(".um-admin-cur-condition").slice(1).remove(),e.find("input[type=text], select").val(""),e.find(".um-admin-new-condition").removeClass("disabled"),UM.modal.responsive()}),jQuery(document.body).on("click",".um-admin-remove-condition",function(e){e.preventDefault();var i=jQuery(this).parents(".um-admin-cur-condition"),e=i.parents(".um-admin-btn-content");i.remove(),e.find(".um-admin-new-condition").removeClass("disabled"),UM.modal.responsive()})});