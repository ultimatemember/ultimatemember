var um_radioStates={};function um_recalculate_indexes(i){i.find(".um-admin-option-row").each(function(i){jQuery(this).show().attr("data-option_index",i).data("option_index",i);var e=jQuery(this).find(".um-admin-option-default-multi").data("base-name"),e=(jQuery(this).find(".um-admin-option-default-multi").attr("name",e+"["+i+"]"),jQuery(this).find(".um-admin-option-default").attr("value",i),jQuery(this).find(".um-admin-option-key").data("base-name")),e=(jQuery(this).find(".um-admin-option-key").attr("name",e+"["+i+"]"),jQuery(this).find(".um-admin-option-val").data("base-name"));jQuery(this).find(".um-admin-option-val").attr("name",e+"["+i+"]")}),um_radio_set_states(i)}function um_multi_or_not(i,e){var e=e.find(".um-admin-option-rows"),t=e.find(".um-admin-option-row");i.is(":checked")?(t.find(".um-admin-option-default-multi").prop("disabled",!1).show(),t.find(".um-admin-option-default").prop("disabled",!0).prop("checked",!1).hide()):(t.find(".um-admin-option-default-multi").prop("disabled",!0).prop("checked",!1).hide(),t.find(".um-admin-option-default").prop("disabled",!1).show()),um_radio_set_states(e)}function um_admin_init_draggable(t){t.sortable({items:".um-admin-option-row",forcePlaceholderSize:!0,update:function(i,e){um_recalculate_indexes(t)}}),um_radio_set_states(t)}function um_radio_set_states(i){um_radioStates={},jQuery.each(i.find(".um-admin-option-default"),function(i,e){um_radioStates[e.value]=jQuery(e).is(":checked")})}function um_maybe_init_tinymce(i){i.children(".um-form-table").children("tbody").children('.um-forms-line[data-field_type="wp_editor"]').find(".um-admin-editor").length&&um_tinymce_init(i.children(".um-form-table").children("tbody").children('.um-forms-line[data-field_type="wp_editor"]').find(".um-admin-editor-content").data("editor_id"),i.children(".um-form-table").children("tbody").children('.um-forms-line[data-field_type="wp_editor"]').find(".um-admin-editor-content").html())}function um_tinymce_init(e,i){tinyMCEPreInit.mceInit[e]=tinyMCEPreInit.mceInit.um_editor_placeholder,tinyMCEPreInit.qtInit[e]=tinyMCEPreInit.qtInit.um_editor_placeholder,tinyMCEPreInit.mceInit[e]=JSON.parse(JSON.stringify(tinyMCEPreInit.mceInit[e]).replaceAll(/um_editor_placeholder/gm,e)),tinyMCEPreInit.qtInit[e]=JSON.parse(JSON.stringify(tinyMCEPreInit.qtInit[e]).replaceAll(/um_editor_placeholder/gm,e));var t=jQuery("<div>").append(jQuery("#wp-um_editor_placeholder-wrap").clone()),n=jQuery('.um-admin-editor-content[data-editor_id="'+e+'"]'),t=(t.find("#um_editor_placeholder").attr("name",n.data("editor_name")),t[0].innerHTML.replaceAll(new RegExp("um_editor_placeholder","gm"),e));n.siblings(".um-admin-editor").replaceWith(t),"object"==typeof tinyMCE&&null!==tinyMCE.get("um_editor_placeholder")?(n.siblings(".wp-editor-wrap").find(".wp-editor-container > .mce-tinymce.mce-container.mce-panel").remove(),"function"==typeof QTags&&(QTags(tinyMCEPreInit.qtInit[e]),QTags._buttonsInit()),tinyMCE.init(tinyMCEPreInit.mceInit[e]),tinyMCE.get(e).setContent(i),jQuery("#"+e).html(i),"object"==typeof window.switchEditors&&window.switchEditors.go(e)):("function"==typeof QTags&&(QTags(tinyMCEPreInit.qtInit[e]),QTags._buttonsInit()),jQuery("#"+e).html(i)),jQuery(document.body).on("click",".wp-switch-editor",function(){var i=jQuery(this);i.hasClass("wp-switch-editor")&&"object"==typeof window.switchEditors&&(i=i.hasClass("switch-tmce")?"tmce":"html",window.switchEditors.go(e,i))}),n.remove()}"undefined"==typeof um_admin_field_groups_data&&(um_admin_field_groups_data={}),"object"!=typeof window.UM&&(window.UM={}),"object"!=typeof UM.fields_groups&&(UM.fields_groups={}),UM.fields_groups={tabs:{setActive:function(i,e){var t=i.data("tab"),i=(i.parents(".um-field-row-tabs").find("div[data-tab]").removeClass("current"),i.addClass("current"),i.parents(".um-field-row-tabs").siblings(".um-field-row-tabs-content"));i.find("div[data-tab]").removeClass("current"),i.find('div[data-tab="'+t+'"]').addClass("current")},compare:function(i,e){if(i.length!==e.length)return!1;for(var t=0;t<i.length;t++)if(i[t]!==e[t])return!1;return!0},compareDeep:function(i,n){if(typeof i!=typeof n)return!1;if("object"!=typeof i)return i===n;{if(!UM.fields_groups.tabs.compare(Object.keys(i),Object.keys(n)))return!1;let t=!0;return Object.entries(i).forEach(([i,e])=>{if(!(t=UM.fields_groups.tabs.compareDeep(e,n[i])))return!1}),t}},reBuild:function(i,e,t){var n=i.children(".um-field-row-content").children(".um-field-row-tabs"),o=i.children(".um-field-row-content").children(".um-field-row-tabs-content"),i=n.children("div[data-tab].current").data("tab");n.children("div[data-tab]").remove(),o.children("div[data-tab]").each(function(){e.includes(t(this).data("tab"))||t(this).remove()});let d="";for(var l=0;l<e.length;l++)d+='<div data-tab="'+e[l]+'">'+um_admin_field_groups_data.field_tabs[e[l]]+"</div>",o.children('div[data-tab="'+e[l]+'"]').length||o.append('<div data-tab="'+e[l]+'"></div>');n.html(d),n.children('div[data-tab="'+i+'"]').addClass("current"),o.children('div[data-tab="'+i+'"]').addClass("current")}},sortable:{init:function(i,e){i.sortable({items:".um-field-row",connectWith:"um-fields-column-content",placeholder:"um-field-row-placeholder",forcePlaceholderSize:!0,axis:"y",cursor:"move",handle:".um-field-row-move-link",update:function(){UM.fields_groups.sortable.update(e(this),e)}}).on("sortupdate",function(){UM.fields_groups.sortable.update(e(this),e)})},update:function(i,e){i.children(".um-field-row").each(function(i){i=+i+1;e(this).children(".um-field-row-order").val(i),e(this).children(".um-field-row-header").children(".um-field-row-move-link").text(i)}),UM.fields_groups.field.conditional.prepareFieldsList(e),UM.fields_groups.field.conditional.showHideConditionalTabs(e),UM.fields_groups.field.conditional.fillRulesFields(e)},destroy:function(i){i.hasClass("ui-sortable")&&i.sortable("destroy")},reInit:function(i,e){UM.fields_groups.sortable.destroy(i),UM.fields_groups.sortable.init(i,e),i.trigger("sortupdate")}},field:{newIndex:0,settingsScreens:{},prepareSettings:function(o,i,d){o(".um-fields-column-content > .um-field-row").each(function(){let t=o(this).data("field"),n=o(this).children(".um-field-row-content").children(".um-field-row-tabs-content").children('div[data-tab="general"]').children(".um-form-table").children("tbody").children('.um-forms-line[data-field_id="type"]').find(".um-field-row-type-select").val();void 0!==i&&i!=t||("object"!=typeof UM.fields_groups.field.settingsScreens[t]&&(UM.fields_groups.field.settingsScreens[t]={}),"object"!=typeof UM.fields_groups.field.settingsScreens[t][n]&&(UM.fields_groups.field.settingsScreens[t][n]={}),o(this).children(".um-field-row-content").children(".um-field-row-tabs").children("div[data-tab]").each(function(){var i,e=o(this).data("tab");void 0!==d&&d!=e||((i=o(this).closest(".um-field-row-tabs").siblings(".um-field-row-tabs-content").children('div[data-tab="'+e+'"]').children(".um-form-table").clone()).find(".wp-editor-wrap").replaceWith('<div class="um-admin-editor"></div><div class="um-admin-editor-content" data-editor_id="'+i.find("textarea.wp-editor-area").attr("id")+'" data-editor_name="'+i.find("textarea.wp-editor-area").attr("name")+'">'+i.find("textarea.wp-editor-area").val()+"</div>"),UM.fields_groups.field.settingsScreens[t][n][e]=i[0].outerHTML)}))})},sanitizeInput:function(i){return i.replace(/<(|\/|[^>\/bi]|\/[^>bi]|[^\/>][^>]+|\/[^>][^>]+)>/g,"")},checkIfMultiple:function(i){i.find(".um-field-row-multiple-input").length&&i.find(".um-field-row-multiple-input").trigger("change")},add:function(i,d){var e=i.closest(".um-fields-column").children(".um-fields-column-content");let t=i.closest(".um-field-row").data("field");void 0===t&&(t=0);i=d(".um-field-row-template").clone().addClass("um-field-row").removeClass("um-field-row-template");UM.fields_groups.field.newIndex++;let l=UM.fields_groups.field.newIndex;i.data("field","new_"+l).attr("data-field","new_"+l);var n=e.find("> .um-field-row").length+1,o=(i.find(".um-field-row-move-link").text(n),i.find(".um-field-row-id")),a=(o.removeAttr("disabled").prop("disabled",!1),o.attr("name")),o=(void 0!==a&&(a=a.replace("{index}",l),o.attr("name",a)),i.find(".um-field-row-parent-id")),a=(o.removeAttr("disabled").prop("disabled",!1),o.attr("name")),o=(void 0!==a&&(a=a.replace("{index}",l),o.attr("name",a).val(t)),i.find(".um-field-row-order")),a=(o.val(n).removeAttr("disabled").prop("disabled",!1),o.attr("name"));void 0!==a&&(n=a.replace("{index}",l),o.attr("name",n)),i.find(".um-form-table").each(function(i){let e=d(this).data("extra-class");void 0!==e&&(e=e.replace("{index}",l))&&d(this).removeAttr("class").removeAttr("data-extra-class").addClass("form-table um-form-table "+e)}),i.find(".um-forms-line").each(function(i){var e=d(this).data("prefix"),e=(void 0!==e&&(e=e.replace("new_index","new_"+l),d(this).data("prefix",e).attr("data-prefix",e)),d(this).find("label")),t=e.attr("for"),e=(void 0!==t&&(t=t.replace("new_index","new_"+l),e.attr("for",t)),d(this).find(".um-forms-field")),t=(d(this).find(".um-conditional-rule-setting").each(function(i){var e=d(this).data("base-name"),e=(void 0!==e&&(e=e.replace("{index}",l),d(this).data("base-name",e).attr("data-base-name",e)),d(this).attr("name"));void 0!==e&&(e=e.replace("{index}",l),d(this).attr("name",e))}),e.attr("id")),n=(void 0!==t&&(n=t.replace("new_index","new_"+l),e.attr("id",n)),e.attr("name"));void 0!==n&&(n=n.replace("{index}",l),e.attr("name",n)),e.removeAttr("disabled").prop("disabled",!1);let o=[e.siblings('input[type="hidden"]'),d(this).find("#"+t+"_hidden")];d.each(o,function(i){var e,i=o[i];i.length&&(void 0!==(e=i.attr("id"))&&(e=e.replace("new_index","new_"+l),i.attr("id",e)),void 0!==(e=i.attr("name"))&&(e=e.replace("{index}",l),i.attr("name",e)),i.removeAttr("disabled").prop("disabled",!1))})}),e.append(i),1<e.children(".um-field-row").length?UM.fields_groups.sortable.reInit(e,d):(e.removeClass("hidden"),e.siblings(".um-fields-column-header").removeClass("hidden"),e.siblings(".um-fields-column-empty-content").addClass("hidden"),UM.fields_groups.sortable.init(e,d)),run_check_conditions(),UM.fields_groups.field.conditional.prepareFieldsList(d),UM.fields_groups.field.conditional.showHideConditionalTabs(d),UM.fields_groups.field.conditional.fillRulesFields(d)},toggleEdit:function(i,e){i.hasClass("um-field-row-edit-mode")?UM.fields_groups.field.hideEdit(i,e):UM.fields_groups.field.showEdit(i,e)},showEdit:function(i,e){i.addClass("um-field-row-edit-mode"),UM.fields_groups.field.checkIfMultiple(i)},hideEdit:function(i,e){i.removeClass("um-field-row-edit-mode")},duplicate:function(i,e){var t=i.closest(".um-fields-column-content"),n=i.closest(".um-field-row").clone();i.closest(".um-field-row").after(n),UM.fields_groups.sortable.reInit(t,e),UM.fields_groups.field.conditional.prepareFieldsList(e)},delete:function(i,e){var t=i.closest(".um-fields-column-content"),i=i.closest(".um-field-row");delete UM.fields_groups.field.settingsScreens[i.data("field")],i.remove(),t.find(".um-field-row").length?UM.fields_groups.sortable.reInit(t,e):(t.addClass("hidden"),t.siblings(".um-fields-column-header").addClass("hidden"),t.siblings(".um-fields-column-empty-content").removeClass("hidden"),UM.fields_groups.sortable.destroy(t)),UM.fields_groups.field.conditional.prepareFieldsList(e),UM.fields_groups.field.conditional.showHideConditionalTabs(e),UM.fields_groups.field.conditional.fillRulesFields(e)},conditional:{fieldsList:{},prepareFieldsList:function(r){r(".um-fields-column-content").each(function(){let a=r(this).data("uniqid");UM.fields_groups.field.conditional.fieldsList[a]={},r(this).children(".um-field-row").each(function(){var i=r(this).children(".um-field-row-content").find('> .um-field-row-tabs-content > div[data-tab="general"] > .um-form-table > tbody > .um-forms-line:not([data-field_type="sub_fields"])'),n=i.find(".um-field-row-type-select").val();if(um_admin_field_groups_data.field_types[n].conditional_rules.length){var o=r(this).data("field"),d=UM.fields_groups.field.sanitizeInput(i.find(".um-field-row-title-input").val()),l=r(this).children(".um-field-row-order").val();let e={},t=(um_admin_field_groups_data.field_types[n].conditional_rules.forEach(i=>{e[i]=um_admin_field_groups_data.conditional_rules[i]}),null);"choice"===um_admin_field_groups_data.field_types[n].category&&(t=[],"bool"===n?t=[{key:0,value:wp.i18n.__("False","ultimate-member")},{key:1,value:wp.i18n.__("True","ultimate-member")}]:i.each(function(){"choices"===r(this).data("field_type")&&r(this).find(".um-admin-option-row").each(function(){var i=r(this).find(".um-admin-option-key").val(),e=r(this).find(".um-admin-option-val").val();t.push({key:i,value:e})})})),UM.fields_groups.field.conditional.fieldsList[a][l]={id:o,type:n,title:d,conditions:e,valueOptions:t,order:l}}})})},showHideConditionalTabs:function(t){t(".um-fields-column-content").each(function(){t(this).children(".um-field-row:first").each(function(){t(this).data("conditional-disabled",!0);var i=t(this).children(".um-field-row-content"),e=i.children(".um-field-row-tabs").children('div[data-tab="conditional"]'),e=(e.hasClass("current")&&e.siblings('div[data-tab="general"]').trigger("click"),e.hide(),i.children(".um-field-row-content").children('div[data-tab="conditional"]'));e.find(".um-forms-field").prop("disabled",!0),e.find(".um-conditional-rule-condition-col .um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!0),e.find(".um-conditional-rule-value-col input.um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!0),e.find(".um-conditional-rule-value-col select.um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!0)}),t(this).children(".um-field-row:not(:first)").each(function(){t(this).data("conditional-disabled",!1);var i=t(this).children(".um-field-row-content"),i=(i.children(".um-field-row-tabs").children('div[data-tab="conditional"]').show(),i.children(".um-field-row-content").children('div[data-tab="conditional"]'));i.find(".um-forms-field").prop("disabled",!1),i.find(".um-conditional-rule-condition-col .um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!1),i.find(".um-conditional-rule-value-col input.um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!1),i.find(".um-conditional-rule-value-col select.um-conditional-rule-setting:not(.um-force-disabled)").prop("disabled",!1)})}),run_check_conditions()},fillRulesFields:function(a){a(".um-fields-column-content").each(function(){let l=a(this).data("uniqid");a(this).children(".um-field-row").each(function(){if(!0!==a(this).data("conditional-disabled")&&void 0!==UM.fields_groups.field.conditional.fieldsList[l]){let n=a(this).children(".um-field-row-order").val();a(this).children(".um-field-row-content").children(".um-field-row-tabs-content").children('div[data-tab="conditional"]').find(".um-conditional-rule-field-col .um-conditional-rule-setting").each(function(){let t=a(this),d=t.val();t.find("option").each(function(){""!==a(this).attr("value")&&a(this).remove()}),a.each(UM.fields_groups.field.conditional.fieldsList[l],function(i,e){i>=n||(t.find('option[value="'+e.id+'"]').length||t.append('<option value="'+e.id+'">'+e.title+"</option>"),String(e.id)===String(d)&&t.val(d).trigger("change"))});var i=a(this).closest(".um-conditional-rule-fields");if(""===d)i.find(".um-conditional-rule-condition-col .um-conditional-rule-setting").prop("disabled",!0),i.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).show(),i.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide();else{var e=a('.um-field-row[data-field="'+d+'"]').children(".um-field-row-order").val();let t=i.find(".um-conditional-rule-condition-col .um-conditional-rule-setting"),n=t.val(),o=(t.prop("disabled",!1),t.find("option").each(function(){""!==a(this).attr("value")&&a(this).remove()}),a.each(UM.fields_groups.field.conditional.fieldsList[l][e].conditions,function(i,e){t.find('option[value="'+i+'"]').length||t.append('<option value="'+i+'">'+e+"</option>"),String(i)===String(n)&&t.val(n)}),null);if(null===UM.fields_groups.field.conditional.fieldsList[l][e].valueOptions)o=i.find(".um-conditional-rule-value-col input.um-conditional-rule-setting"),""!==n&&"!=empty"!==n&&"==empty"!==n?o.prop("disabled",!1):o.prop("disabled",!0),o.show(),i.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide();else{let t=(o=i.find(".um-conditional-rule-value-col select.um-conditional-rule-setting")).val();i.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).hide(),""!==n&&"!=empty"!==n&&"==empty"!==n?o.prop("disabled",!1):o.prop("disabled",!0),o.show(),o.find("option").each(function(){""!==a(this).attr("value")&&a(this).remove()}),a.each(UM.fields_groups.field.conditional.fieldsList[l][e].valueOptions,function(i,e){o.find('option[value="'+e.key+'"]').length||o.append('<option value="'+e.key+'">'+e.value+"</option>"),String(e.key)===String(t)&&o.val(t)})}}})}})})},reset:function(i,e){i.parents('.um-field-row-tabs-content > div[data-tab="conditional"]').find(".um-conditional-rules-wrapper .um-conditional-remove-rule").each(function(i){e(this).trigger("click")})},addRulesGroup:function(i,t){var e=i.siblings(".um-conditional-rules-group-template").clone().addClass("um-conditional-rules-group").removeClass("um-conditional-rules-group-template");let n=i.find(".um-conditional-rules-group").length;e.data("group-index",n).attr("data-group-index",n),e.find(".um-conditional-rule-setting").each(function(i){var e=t(this).attr("name");void 0!==e&&(e=e.replace("{group_key}",n),t(this).attr("name",e),t(this).parents(".um-conditional-rule-field-col").length)&&t(this).prop("disabled",!1).removeAttr("disabled")}),i.find(".um-conditional-rules-wrapper-bottom").before(e),UM.fields_groups.field.conditional.showReset(i,t)},addRule:function(i,t){var e=i.parents(".um-conditional-rules-wrapper"),n=e.siblings(".um-conditional-rule-row-template").clone().addClass("um-conditional-rule-row").removeClass("um-conditional-rule-row-template");let o=i.parents(".um-conditional-rules-group").data("group-index"),d=i.parents(".um-conditional-rules-group").find(".um-conditional-rule-row").length;n.find(".um-conditional-rule-setting").each(function(i){var e=t(this).attr("name");if(void 0!==e){let i=e.replace("{group_key}",o);i=i.replace("{row_key}",d),t(this).attr("name",i),t(this).parents(".um-conditional-rule-field-col").length&&t(this).prop("disabled",!1).removeAttr("disabled")}}),i.after(n),UM.fields_groups.field.conditional.changeInputIndex(e,t),UM.fields_groups.field.conditional.showReset(e,t)},removeRule:function(i,e){var t=i.parents(".um-conditional-rules-wrapper"),n=t.find(".um-conditional-rule-row");1===n.length?(n.find(".um-conditional-rule-field-col select").val(""),n.find(".um-conditional-rule-condition-col select").val(""),n.find(".um-conditional-rule-value-col select,.um-conditional-rule-value-col input").val(""),UM.fields_groups.field.conditional.hideReset(t,e)):((1===(n=i.parents(".um-conditional-rules-group")).find(".um-conditional-rule-row").length?n:i).remove(),UM.fields_groups.field.conditional.changeInputIndex(t,e))},changeInputIndex:function(i,n){let o=0;i.find(".um-conditional-rules-group").each(function(i){let t=0;n(this).find(".um-conditional-rule-row").each(function(i){n(this).find(".um-conditional-rule-setting").each(function(i){var e=n(this).data("base-name");if(void 0!==e){let i=e.replace("{group_key}",o);i=i.replace("{row_key}",t),n(this).attr("name",i)}}),t++}),n(this).data("group-index",o).attr("data-group-index",o),o++})},showReset:function(i,e){i.parents('.um-field-row-tabs-content > div[data-tab="conditional"]').find(".um-field-row-reset-all-conditions").css({visibility:"visible"})},hideReset:function(i,e){i.parents('.um-field-row-tabs-content > div[data-tab="conditional"]').find(".um-field-row-reset-all-conditions").css({visibility:"hidden"})},parseRules:function(i,e){let t=[];return i.find(".um-conditional-rule-field-col select,.um-conditional-rule-condition-col select,.um-conditional-rule-value-col select,.um-conditional-rule-value-col input").each(function(i){""!==e(this).val()&&t.push(e(this))}),t},isEmpty:function(i,e){return!UM.fields_groups.field.conditional.parseRules(i,e).length}},changeType:function(e,o){let n=e.data("field");var i=e.data("previousValue"),t=um_admin_field_groups_data.field_types[i].settings;let d=e.children(".um-field-row-content").children(".um-field-row-tabs"),l=e.children(".um-field-row-content").children(".um-field-row-tabs-content");var a=l.children('div[data-tab="general"]').children(".um-form-table").children("tbody").children('.um-forms-line[data-field_id="type"]').find(".um-field-row-type-select");let r=a.val();var s=um_admin_field_groups_data.field_types[r].settings,u=Object.keys(t),c=Object.keys(s),a=a.find('option[value="'+r+'"]').html();if(e.find("> .um-field-row-header > .um-field-row-type").text(UM.fields_groups.field.sanitizeInput(a)),"object"==typeof UM.fields_groups.field.settingsScreens[n]&&"object"==typeof UM.fields_groups.field.settingsScreens[n][i]&&o.each(UM.fields_groups.field.settingsScreens[n][i],function(i,e){var i=l.children('div[data-tab="'+i+'"]').children(".um-form-table").children("tbody").children('.um-forms-line[data-field_type="wp_editor"]').find("textarea.wp-editor-area");i.length&&(i=i.attr("id"),"object"==typeof tinyMCE)&&null!==tinyMCE.get(i)&&(tinyMCE.triggerSave(),tinyMCE.EditorManager.execCommand("mceRemoveEditor",!0,i),"4"===tinyMCE.majorVersion?window.tinyMCE.execCommand("mceRemoveEditor",!0,i):window.tinyMCE.execCommand("mceRemoveControl",!0,i))}),UM.fields_groups.tabs.compare(u,c)||UM.fields_groups.tabs.reBuild(e,c,o),d.children("div[data-tab]").addClass("disabled"),"object"==typeof UM.fields_groups.field.settingsScreens[n]&&"object"==typeof UM.fields_groups.field.settingsScreens[n][r])o.each(UM.fields_groups.field.settingsScreens[n][r],function(i,e){var t=l.children('div[data-tab="'+i+'"]');let n=o("<div>").append(e).find(".form-table");"conditional"===i&&n.find('[data-field_type="conditional_rules"]').html(t.find('[data-field_type="conditional_rules"]').html()),t.find(".um-field-row-static-setting").each(function(){let i=o(this).val();n.find('[name="'+o(this).attr("name")+'"]').each(function(){"hidden"!==o(this).attr("type")&&"checkbox"!==o(this).attr("type")&&o(this).val(i)})}),t.html(n[0].outerHTML),um_maybe_init_tinymce(t)}),l.children('div[data-tab="general"]').children(".um-form-table").children("tbody").children('.um-forms-line[data-field_id="type"]').find(".um-field-row-type-select").removeClass("disabled").prop("disabled",!1),run_check_conditions(),UM.fields_groups.field.conditional.prepareFieldsList(o),d.children("div[data-tab]").removeClass("disabled"),UM.fields_groups.field.checkIfMultiple(e);else{if(!UM.fields_groups.tabs.compareDeep(t.general,s.general)){l.children('div[data-tab="general"]').find("> .form-table > tbody > .um-forms-line .um-forms-field:not(.um-field-row-static-setting)").closest(".um-forms-line").remove();var f=Object.keys(s.general).length-2;if(0<f){let i=0;for(;i<f;)l.children('div[data-tab="general"]').children(".form-table").children("tbody").append('<tr class="um-forms-line um-forms-skeleton"><th><span class="um-skeleton-box" style="width:100%;height:20px;"></span></th><td><span class="um-skeleton-box" style="width:100%;height:40px;margin-bottom:4px;"></span><span class="um-skeleton-box" style="width:100%;height:14px;"></span></td></tr>'),i++}}wp.ajax.send("um_fields_groups_get_settings_form",{data:{field_id:n,type:r,nonce:um_admin_scripts.nonce},success:function(i){"object"!=typeof UM.fields_groups.field.settingsScreens[n]&&(UM.fields_groups.field.settingsScreens[n]={}),"object"!=typeof UM.fields_groups.field.settingsScreens[n][r]&&(UM.fields_groups.field.settingsScreens[n][r]={}),o.each(i.fields,function(i,e){UM.fields_groups.field.settingsScreens[n][r][i]=e;let t=o("<div>").append(e).find(".form-table");e=l.children('div[data-tab="'+i+'"]');"conditional"===i&&t.find('[data-field_type="conditional_rules"]').html(e.find('[data-field_type="conditional_rules"]').html()),e.find(".um-field-row-static-setting").each(function(){let i=o(this).val();t.find('[name="'+o(this).attr("name")+'"]').each(function(){"hidden"!==o(this).attr("type")&&"checkbox"!==o(this).attr("type")&&o(this).val(i)})}),e.html(t[0].outerHTML),um_maybe_init_tinymce(e)}),l.children('div[data-tab="general"]').children(".um-form-table").children("tbody").children('.um-forms-line[data-field_id="type"]').find(".um-field-row-type-select").removeClass("disabled").prop("disabled",!1),run_check_conditions(),UM.fields_groups.field.conditional.prepareFieldsList(o),d.children("div[data-tab]").removeClass("disabled"),UM.fields_groups.field.checkIfMultiple(e)},error:function(i){console.error(i)}})}}}},jQuery(function(a){a(".um-field-row > .um-field-row-id").each(function(){""===a(this).val()&&UM.fields_groups.field.newIndex++});a(".um-fields-column-content").each(function(){UM.fields_groups.sortable.init(a(this),a)}),UM.fields_groups.field.conditional.prepareFieldsList(a),UM.fields_groups.field.conditional.showHideConditionalTabs(a),UM.fields_groups.field.conditional.fillRulesFields(a),console.log("-------- Conditional -----------"),console.log(UM.fields_groups.field.conditional.fieldsList),console.log("-------------"),UM.fields_groups.field.prepareSettings(a),console.log(UM.fields_groups.field.settingsScreens),a(document.body).on("click",".um-field-row",function(i){var e;void 0!==i.target&&i.target.classList.contains("um-field-row-toggle-edit")&&(i.preventDefault(),e=a(this),UM.fields_groups.field.toggleEdit(e,a),i.stopPropagation())}),a(document.body).on("click",".um-field-row-action-edit",function(i){i.preventDefault();i=a(this).closest(".um-field-row");UM.fields_groups.field.toggleEdit(i,a)}),a(document.body).on("click",".um-field-row-action-delete",function(i){i.preventDefault(),confirm(wp.i18n.__("Are you sure you want to delete this field?","ultimate-member"))&&UM.fields_groups.field.delete(a(this),a)}),a(document.body).on("click",".um-field-row-action-duplicate",function(i){i.preventDefault(),confirm(wp.i18n.__("Are you sure you want to duplicate this field?","ultimate-member"))&&UM.fields_groups.field.duplicate(a(this),a)}),a(document.body).on("click",".um-add-field-to-column",function(i){i.preventDefault(),UM.fields_groups.field.add(a(this),a)}),a(document.body).on("click",".um-field-row-tabs > div[data-tab]:not(.current)",function(i){i.preventDefault(),a(this).hasClass("disabled")||UM.fields_groups.tabs.setActive(a(this),a)}),a(document.body).on("click",".um-field-row-reset-all-conditions",function(i){i.preventDefault(),confirm(wp.i18n.__("Are you sure?","ultimate-member"))&&UM.fields_groups.field.conditional.reset(a(this),a)}),a(document.body).on("click",".um-conditional-add-rules-group",function(i){i.preventDefault();i=a(this).parents(".um-conditional-rules-wrapper");UM.fields_groups.field.conditional.addRulesGroup(i,a)}),a(document.body).on("click",".um-conditional-add-rule",function(i){i.preventDefault();i=a(this).parents(".um-conditional-rule-row");UM.fields_groups.field.conditional.addRule(i,a)}),a(document.body).on("click",".um-conditional-remove-rule",function(i){i.preventDefault();i=a(this).parents(".um-conditional-rule-row");UM.fields_groups.field.conditional.removeRule(i,a)}),a(document.body).on("change",".um-conditional-rule-field-col select, .um-conditional-rule-condition-col select, .um-conditional-rule-value-col select,.um-conditional-rule-value-col input",function(i){var e=a(this).parents('.um-field-row-tabs-content > div[data-tab="conditional"]');UM.fields_groups.field.conditional.isEmpty(e,a)?UM.fields_groups.field.conditional.hideReset(a(this),a):UM.fields_groups.field.conditional.showReset(a(this),a)}),a(document.body).on("change",".um-conditional-rule-field-col .um-conditional-rule-setting",function(i){var e=a(this).closest(".um-fields-column-content").data("uniqid");if(void 0!==UM.fields_groups.field.conditional.fieldsList[e]){var o=a(this).val(),d=a(this).closest(".um-conditional-rule-fields");if(""===o)d.find(".um-conditional-rule-condition-col .um-conditional-rule-setting").prop("disabled",!0),d.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).show(),d.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide();else{o=a('.um-field-row[data-field="'+o+'"]').children(".um-field-row-order").val();let t=d.find(".um-conditional-rule-condition-col .um-conditional-rule-setting"),n=(t.prop("disabled",!1),t.find("option").each(function(){""!==a(this).attr("value")&&a(this).remove()}),a.each(UM.fields_groups.field.conditional.fieldsList[e][o].conditions,function(i,e){t.find('option[value="'+i+'"]').length||t.append('<option value="'+i+'">'+e+"</option>")}),null);null===UM.fields_groups.field.conditional.fieldsList[e][o].valueOptions?((n=d.find(".um-conditional-rule-value-col input.um-conditional-rule-setting")).prop("disabled",!1).show(),d.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).hide()):(n=d.find(".um-conditional-rule-value-col select.um-conditional-rule-setting"),d.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).hide(),n.prop("disabled",!1).show(),n.find("option").each(function(){""!==a(this).attr("value")&&a(this).remove()}),a.each(UM.fields_groups.field.conditional.fieldsList[e][o].valueOptions,function(i,e){n.find('option[value="'+e.key+'"]').length||n.append('<option value="'+e.key+'">'+e.value+"</option>")})),t.val("").trigger("change"),n.val("").trigger("change")}}}),a(document.body).on("change",".um-conditional-rule-condition-col .um-conditional-rule-setting",function(i){var e,t,n,o=a(this).closest(".um-fields-column-content").data("uniqid");void 0!==UM.fields_groups.field.conditional.fieldsList[o]&&(e=a(this).val(),n=(t=a(this).closest(".um-conditional-rule-fields")).find(".um-conditional-rule-field-col .um-conditional-rule-setting").val(),n=a('.um-field-row[data-field="'+n+'"]').children(".um-field-row-order").val(),""===e||"!=empty"===e||"==empty"===e?(t.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).val("").show(),t.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).val("").hide()):null===UM.fields_groups.field.conditional.fieldsList[o][n].valueOptions?(t.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!1).val("").show(),t.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!0).val("").hide()):(t.find(".um-conditional-rule-value-col input.um-conditional-rule-setting").prop("disabled",!0).val("").hide(),t.find(".um-conditional-rule-value-col select.um-conditional-rule-setting").prop("disabled",!1).val("").show()))}),a(document.body).on("change",".um-forms-field:not(.um-field-row-type-select)",function(i){var e=a(this).closest(".um-field-row").data("field"),t=a(this).closest("div[data-tab]").data("tab");UM.fields_groups.field.prepareSettings(a,e,t)}),a(document.body).on("focusin",".um-field-row-type-select",function(){a(this).closest(".um-field-row").data("previousValue",a(this).val())}).on("change",".um-field-row-type-select",function(){var i;a(this).hasClass("disabled")||(a(this).addClass("disabled").prop("disabled",!0),i=a(this).closest(".um-field-row"),UM.fields_groups.field.changeType(i,a))}),a(document.body).on("change",".um-field-row-title-input",function(i){var e=a(this).val();a(this).closest(".um-field-row").find("> .um-field-row-header > .um-field-row-title").text(UM.fields_groups.field.sanitizeInput(e)),UM.fields_groups.field.conditional.prepareFieldsList(a)}),a(document.body).on("change",".um-field-row-metakey-input",function(i){let e=wp.i18n.__("(no metakey)","ultimate-member");""!==a(this).val()&&(e=a(this).val()),a(this).closest(".um-field-row").find("> .um-field-row-header > .um-field-row-metakey").text(UM.fields_groups.field.sanitizeInput(e))}),a(document.body).on("click",".um-admin-option-bulk-toggle",function(){var i=a(this).parents(".um-admin-option-bulk-add-wrapper").siblings(".um-admin-option-bulk-add-list");i.is(":visible")?(i.slideUp(),a(this).text(a(this).data("show-label"))):(i.slideDown(),a(this).text(a(this).data("hide-label")))}),a(document.body).on("click",".um-admin-option-bulk-add",function(){if(!a(this).hasClass("disabled")){var d=a(this).data("bulk_value");let e=a(this).parents(".um-admin-option-bulk-add-list"),n=a(this).parents(".um-admin-option-bulk-add-list").siblings(".um-admin-option-rows"),o=a(this).parents(".um-admin-option-bulk-add-list").siblings(".um-admin-option-rows").find(".um-admin-option-row"),i=!1,t=(!(1<o.length)&&""===o.first().find(".um-admin-option-key").val()&&""===o.first().find(".um-admin-option-val").val()||(i=!0),!1);if((!i||confirm(wp.i18n.__("All current option will be removed. Are you sure you want to fill option by this preset?","ultimate-member")))&&(t=!0)){o.hide();let i=6<o.length?6:o.length;for(;0<i;){var l=a(".um-admin-option-row-skeleton-placeholder").clone().addClass("um-admin-option-row-skeleton").removeClass("um-admin-option-row-skeleton-placeholder");n.prepend(l),i--}e.siblings(".um-admin-option-bulk-add-wrapper").find(".um-admin-option-bulk-toggle").trigger("click"),e.find(".um-admin-option-bulk-add").addClass("disabled"),wp.ajax.send("um_fields_groups_get_options_preset",{data:{preset:d,nonce:um_admin_scripts.nonce},success:function(t){o.each(function(){a(this).find(".um-admin-option-row-remove").trigger("click")});let i=Object.keys(t.options).length-1;for(;0<i;)n.find(".um-admin-option-row").first().find(".um-admin-option-row-add").trigger("click"),i--;a.each(t.options,function(i){var e=Object.keys(t.options).indexOf(i);n.find(".um-admin-option-key:eq("+e+")").val(i),n.find(".um-admin-option-val:eq("+e+")").val(t.options[i])}),n.find(".um-admin-option-row-skeleton").remove(),o.show(),e.find(".um-admin-option-bulk-add").removeClass("disabled")},error:function(i){console.error(i)}})}}}),a(document.body).on("change",".um-field-row-multiple-input",function(){var i=a(this).closest(".um-field-row");um_multi_or_not(a(this),i)}),a(document.body).on("click",".um-admin-option-rows .um-admin-option-default",function(){var t=a(this).val();a(this).prop("checked",um_radioStates[t]=!um_radioStates[t]),a.each(a(".um-admin-option-rows .um-admin-option-default"),function(i,e){e.value!==t&&(um_radioStates[e.value]=!1)})}),a(document.body).on("click",".um-admin-option-row-add",function(){var i=a(this).parents(".um-field-row"),e=i.find(".um-field-row-multiple-input"),t=a(this).parents(".um-admin-option-row"),n=a(this).parents(".um-admin-option-rows"),o=n.siblings(".um-admin-option-row-placeholder")[0].outerHTML.replace("um-admin-option-row-placeholder","um-admin-option-row"),o=a("<div>").append(o);o.find(".um-admin-option-key").prop("disabled",!1),o.find(".um-admin-option-val").prop("disabled",!1),o.find(".um-admin-option-default").prop("disabled",!1),o.find(".um-admin-option-default-multi").prop("disabled",!1),o.find(".um-admin-option-row").insertAfter(t),um_recalculate_indexes(n),"both"===n.data("multiple")&&um_multi_or_not(e,i),um_admin_init_draggable(n)}),a(document.body).on("click",".um-admin-option-row-remove",function(){var i=a(this).parents(".um-admin-option-row"),e=a(this).parents(".um-admin-option-rows");1===a(this).parents(".um-admin-option-rows").find(".um-admin-option-row").length?(i.find(".um-admin-option-key").val(""),i.find(".um-admin-option-val").val(""),i.find(".um-admin-option-default").prop("checked",!1),i.find(".um-admin-option-default-multi").prop("checked",!1)):(i.remove(),um_recalculate_indexes(e),um_admin_init_draggable(e))});var i,e,t=a("#message[data-error-field]");0<t.length&&(i=t.data("error-field"),(i=a("#"+i)).is(":visible")||i.closest(".um-field-row:not(.um-field-row-edit-mode)").find("> .um-field-row-header > .um-field-row-actions > .um-field-row-action-edit").trigger("click"),i.is(":visible")||(e=i.closest(".um-form-table").parent().data("tab"),i.closest(".um-field-row.um-field-row-edit-mode").find('> .um-field-row-content > .um-field-row-tabs > div[data-tab="'+e+'"]').trigger("click")),i.addClass("um-error"),t[0].scrollIntoView())});