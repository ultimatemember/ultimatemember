!function(a){function t(){this.M=[],this.defaultOptions={attributes:{},classes:"",duration:400,footer:"",header:"",size:"normal",template:"",content:""},this.defaultTemplate='<div class="um um-modal"><span class="um-modal-close">&times;</span><div class="um-modal-header"></div><div class="um-modal-body"></div><div class="um-modal-footer"></div></div>'}t.prototype={constructor:t,addModal:function(t,e){t=this.filterOptions(t);let n;(n=t.template&&(o=wp.template(t.template))?a(o(t)):n)||(n=a(this.defaultTemplate),t.header?n.find(".um-modal-header").html(t.header):n.find(".um-modal-header").remove(),t.footer?n.find(".um-modal-footer").html(t.footer):n.find(".um-modal-footer").remove());var o,i=n.find(".um-modal-body");switch(typeof t.content){case"function":let o=t.content.apply(n,[e,t]);"object"==typeof o&&"number"==typeof o.readyState&&"function"==typeof o.done?(wp.hooks.doAction("um-modal-before-ajax",n,t,o),this.loading(!0,n),o.done(function(t){wp.hooks.doAction("um-modal-after-ajax",n,t,o),UM.modal.loading(!1,n)})):this.setContent(o,n);break;case"object":this.setContent(a(t.content).clone(),n);break;case"string":"loading"===t.content?this.loading(!0,n):/^https?:/.test(t.content)?(this.loading(!0,n),i.load(t.content.trim(),function(){this.loading(!1,n),UM.modal.responsive(n)})):/^(#|\.)/.test(t.content)&&a(t.content).length?this.setContent(a(t.content).clone().children(),n):this.setContent(t.content,n);break;default:this.setContent(t.content,n)}if("object"==typeof(n.get(0).umModalOptions=t).attributes)for(var d in t.attributes)n.attr(d,t.attributes[d]);return t.classes.length&&n.addClass(t.classes),t.size.length&&n.addClass(t.size),n.on("click",'a:not([href^="javascript"])',this.stopEvent),n.on("touchmove",this.stopEvent),i.find("img").on("load",function(){UM.modal.responsive(n)}),wp.hooks.doAction("um-modal-before-add",n,t),this.hide(),this.M.push(n),this.show(n),n},addOverlay:function(){return a("body > .um-modal-overlay").length<1&&a(document.body).addClass("um-overflow-hidden").append('<div class="um-modal-overlay"></div>').on("touchmove",this.stopEvent),a("body > .um-modal-overlay")},clear:function(){this.M=[],a(document.body).removeClass("um-overflow-hidden").off("touchmove").children(".um-modal-overlay, .um-modal").remove(),"hidden"===a(document.body).css("overflow-y")&&a(document.body).css("overflow-y","visible")},close:function(){var t=this.getModal();return t&&t.length&&wp.hooks.doAction("um-modal-before-close",t),1<this.M.length?(this.M.pop().remove(),this.show()):this.clear(),this},closeAll:function(){var t=this.getModal();return t&&t.length&&wp.hooks.doAction("um-modal-before-close",t),this.clear(),this},filterOptions:function(t){var o=wp.hooks.applyFilters("um-modal-def-options",this.defaultOptions);return a.extend({},o,t)},getModal:function(e){let n;return"object"==typeof e?n=a(e):"string"==typeof e&&1<=this.M.length?a.each(this.M,function(t,o){o.is(e)&&(n=o)}):n=1<=this.M.length?this.M[this.M.length-1]:a("div.um-modal:not(.um-modal-hidden)").filter(":visible"),n.length?n.last():null},hide:function(t){t=this.getModal(t);return t&&(t.detach(),wp.hooks.doAction("um-modal-hidden",t)),t},loading:function(t,o){o=this.getModal(o);return t?(o.addClass("loading"),o.on("click",this.stopEvent)):(o.removeClass("loading"),o.off("click")),this},responsive:function(n){n=this.getModal(n);if(n){n.css({opacity:0});var i=+n.find(".um-modal-header").outerHeight(),d=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let t=n.find(".um-modal-body > img").filter(":visible"),o={},e={};t.length?(t.css({maxHeight:.8*a,maxWidth:.8*d}),o.bottom=(a-n.innerHeight())/2+"px",o.marginLeft="-"+t.width()/2+"px",o.width=t.width()):d<=340||d<=500?(o.bottom=0,o.height=a,o.width=d):(d<=800||d<=960||960<d)&&(o.bottom=(a-n.innerHeight())/2+"px",o.maxHeight=a-30,e.maxHeight=o.maxHeight-i),n.width()>d&&(o.width=.9*d,o.marginLeft="-"+o.width/2+"px"),o=wp.hooks.applyFilters("um-modal-responsive",o,n),n.css(o),n.css({opacity:1}),n.find(".um-modal-body").css(e)}return this},setContent:function(t,o){o=this.getModal(o);return o&&(o.find(".um-modal-body").html(t),wp.hooks.doAction("um-modal-content-added",o)),this},show:function(t){var o,t=this.getModal(t);return t&&(o=t.get(0).umModalOptions,this.addOverlay().after(t),this.responsive(t),t.animate({opacity:1},o.duration),wp.hooks.doAction("um-modal-shown",t)),t},buttonClick:function(t){t.preventDefault(),wp.hooks.doAction("um-modal-button-clicked",t.data.settings,t),UM.modal.addModal(t.data.settings,t)},stopEvent:function(t){t.preventDefault(),t.stopPropagation()},destroy:function(t){t=this.getModal(t);return t&&(wp.hooks.doAction("um-modal-before-destroy",t),t.each(function(t){var o=a(this)[0].umModalOptions.relatedButton;o.off("click",UM.modal.buttonClick),o.data("um-modal-ready",!1)}),this.clear()),t}},void 0===window.UM&&(window.UM={}),UM.modal=new t,a(document.body).on("click",".um-modal-overlay, .um-modal-close",function(t){t.preventDefault(),UM.modal.close()}),a(window).on("load",function(){UM.modal.responsive()}),a(window).on("resize",function(){UM.modal.responsive()}),a.fn.umModal=function(t){const e=a.extend({classes:"",duration:400,footer:"",header:"",size:"normal",content:""},t);return this.each(function(t){var o=a(this);o.data("um-modal-ready")||((e.relatedButton=o).on("click",{settings:e},UM.modal.buttonClick),o.data("um-modal-ready",!0))}),this}}(jQuery);