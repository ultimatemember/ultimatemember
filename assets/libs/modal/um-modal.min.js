!function(d){function t(){this.M=[],this.defaultOptions={attributes:{},classes:"",content:"",duration:400,footer:"",header:"",size:"normal",template:""},this.defaultTemplate='<div class="um-modal"><span class="um-modal-close">&times;</span><div class="um-modal-header"></div><div class="um-modal-body"></div><div class="um-modal-footer"></div></div>'}t.prototype={constructor:t,addModal:function(o,t){o=this.filterOptions(o);let n;if(o.template){let t=wp.template(o.template);t&&(n=d(t(o)))}n||(n=d(this.defaultTemplate),o.header?n.find(".um-modal-header").html(o.header):n.find(".um-modal-header").remove(),o.footer?n.find(".um-modal-footer").html(o.footer):n.find(".um-modal-footer").remove());let i=n.find(".um-modal-body");switch(typeof o.content){case"function":let e=o.content.apply(n,[t,o]);"object"==typeof e&&"function"==typeof e.done&&"function"==typeof e.fail?(wp.hooks.doAction("um-modal-before-ajax",n,o,e),this.loading(!0,n),e.done(function(t){UM.modal.loading(!1,n);var o="string"==typeof t?t:"object"==typeof t&&"string"==typeof t.data?t.data:"";o&&i.is(":empty")?UM.modal.setContent(o,n).responsive(n):console.warn("UM-Modal: received modal content is empty."),wp.hooks.doAction("um-modal-after-ajax",n,t,e)}),e.fail(function(t){UM.modal.loading(!1,n),console.error(t),wp.hooks.doAction("um-modal-after-ajax-fail",n,t,e)})):this.setContent(e,n);break;case"object":this.setContent(d(o.content).clone(),n);break;case"string":"loading"===o.content?this.loading(!0,n):/^https?:/.test(o.content)?(this.loading(!0,n),i.load(o.content.trim(),function(){this.loading(!1,n),UM.modal.responsive(n)})):/^(#|\.)/.test(o.content)&&d(o.content).length?this.setContent(d(o.content).clone().children(),n):this.setContent(o.content,n);break;default:this.setContent(o.content,n)}if("object"==typeof(n.get(0).umModalOptions=o).attributes)for(var e in o.attributes)n.attr(e,o.attributes[e]);return o.classes.length&&n.addClass(o.classes),o.size.length&&n.addClass(o.size),n.on("click",'a:not([href^="javascript"])',this.stopEvent),n.on("touchmove",this.stopEvent),i.find("img").on("load",function(){UM.modal.responsive(n)}),wp.hooks.doAction("um-modal-before-add",n,o),this.hide(),this.M.push(n),this.show(n),n},addOverlay:function(){return d("body > .um-modal-overlay").length<1&&d(document.body).addClass("um-overflow-hidden").append('<div class="um-modal-overlay"></div>').on("touchmove",this.stopEvent),d("body > .um-modal-overlay")},clear:function(){return this.M=[],d(document.body).removeClass("um-overflow-hidden").off("touchmove").children(".um-modal-overlay, .um-modal").remove(),"hidden"===d(document.body).css("overflow-y")&&d(document.body).css("overflow-y","visible"),this},close:function(){var t=this.getModal();return t&&t.length&&wp.hooks.doAction("um-modal-before-close",t),1<this.M.length?(this.M.pop().remove(),this.show()):this.clear(),this},closeAll:function(){var t=this.getModal();return t&&t.length&&wp.hooks.doAction("um-modal-before-close",t),this.clear(),this},filterOptions:function(t){var o=wp.hooks.applyFilters("um-modal-def-options",this.defaultOptions);return d.extend({},o,t)},getModal:function(e){let n;return"object"==typeof e?n=d(e):"string"==typeof e&&1<=this.M.length?d.each(this.M,function(t,o){o.is(e)&&(n=o)}):n=1<=this.M.length?this.M[this.M.length-1]:d("div.um-modal:not(.um-modal-hidden)").filter(":visible"),n.length?n.last():null},hide:function(t){let o=this.getModal(t);return o&&(o.detach(),wp.hooks.doAction("um-modal-hidden",o)),o},loading:function(t,o){let e=this.getModal(o);return t?(e.addClass("loading"),e.on("click",this.stopEvent)):(e.removeClass("loading"),e.off("click")),this},responsive:function(n){let i=this.getModal(n);if(i){i.removeClass("uimob340").removeClass("uimob500").removeClass("uimob800").removeClass("uimob960");var d=+i.find(".um-modal-header").outerHeight(),a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,n=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let t=i.find(".um-modal-body > img").filter(":visible"),o={},e={};t.length?(t.css({maxHeight:.8*n,maxWidth:.8*a}),o.bottom=(n-i.innerHeight())/2+"px",o.marginLeft="-"+t.width()/2+"px",o.width=t.width()):a<=340?(o.bottom=0,o.height=n,o.width=a,i.addClass("uimob340")):a<=500?(o.bottom=0,o.height=n,o.width=a,i.addClass("uimob500")):a<=800?(o.bottom=(n-i.innerHeight())/2+"px",o.maxHeight=n-30,e.maxHeight=o.maxHeight-d,i.addClass("uimob800")):a<=960?(o.bottom=(n-i.innerHeight())/2+"px",o.maxHeight=n-30,e.maxHeight=o.maxHeight-d,i.addClass("uimob960")):960<a&&(o.bottom=(n-i.innerHeight())/2+"px",o.maxHeight=n-30,e.maxHeight=o.maxHeight-d),i.width()>a&&(o.width=.9*a,o.marginLeft="-"+o.width/2+"px"),o=wp.hooks.applyFilters("um-modal-responsive",o,i),i.css(o),i.find(".um-modal-body").css(e)}return this},setContent:function(t,o){let e=this.getModal(o);return e&&(e.find(".um-modal-body").html(t),wp.hooks.doAction("um-modal-content-added",e)),this},show:function(t){let o=this.getModal(t);return o&&(t=o.get(0).umModalOptions,this.addOverlay().after(o),this.responsive(o),o.animate({opacity:1},t.duration),wp.hooks.doAction("um-modal-shown",o)),o},stopEvent:function(t){return t.preventDefault(),t.stopPropagation(),this}},void 0===window.UM&&(window.UM={}),UM.modal=new t,d(document.body).on("click",".um-modal-overlay, .um-modal-close",function(t){t.preventDefault(),UM.modal.close()}),d(window).on("load",function(){UM.modal.responsive()}),d(window).on("resize",function(){UM.modal.responsive()}),d.fn.umModal=function(e){return this.on("click",function(t){t.preventDefault();var o=d.extend(UM.modal.defaultOptions,e||{},{relatedButton:d(t.currentTarget)});wp.hooks.doAction("um-modal-button-clicked",o,t),UM.modal.addModal(o,t)}).data("um-modal-ready",!0),this}}(jQuery);