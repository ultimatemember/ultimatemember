!function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):this.Picker=e(jQuery)}(function(m){var o=m(window),g=m(document),r=m(document.documentElement),v=null!=document.documentElement.style.transition;function y(r,e,t,n){if(!r)return y;function o(){return this.start()}var i=!1,d={id:r.id||"P"+Math.abs(~~(Math.random()*new Date))},u=t?m.extend(!0,{},t.defaults,n):n||{},a=m.extend({},y.klasses(),u.klass),c=m(r),s=o.prototype={constructor:o,$node:c,start:function(){return d&&d.start?s:(d.methods={},d.start=!0,d.open=!1,d.type=r.type,r.autofocus=r==x(),r.readOnly=!u.editable,r.id=r.id||d.id,"text"!=r.type&&(r.type="text"),s.component=new t(s,u),s.$root=m('<div class="'+a.picker+'" id="'+r.id+'_root" />'),b(s.$root[0],"hidden",!0),s.$holder=m(l()).appendTo(s.$root),f(),u.formatSubmit&&function(){var e;!0===u.hiddenName?(e=r.name,r.name=""):e=(e=["string"==typeof u.hiddenPrefix?u.hiddenPrefix:"","string"==typeof u.hiddenSuffix?u.hiddenSuffix:"_submit"])[0]+r.name+e[1];s._hidden=m('<input type=hidden name="'+e+'"'+(c.data("value")||r.value?' value="'+s.get("select",u.formatSubmit)+'"':"")+">")[0],c.on("change."+d.id,function(){s._hidden.value=r.value?s.get("select",u.formatSubmit):""})}(),function(){c.data(e,s).addClass(a.input).val(c.data("value")?s.get("select",u.format):r.value).on("focus."+d.id+" click."+d.id,function(o,r,i){var a;return function(){var e=this,t=arguments,n=i&&!a;clearTimeout(a),a=setTimeout(function(){a=null,i||o.apply(e,t)},r),n&&o.apply(e,t)}}(function(e){e.preventDefault(),s.open()},100)),u.editable||c.on("keydown."+d.id,h);b(r,{haspopup:!0,expanded:!1,readonly:!1,owns:r.id+"_root"})}(),u.containerHidden?m(u.containerHidden).append(s._hidden):c.after(s._hidden),u.container?m(u.container).append(s.$root):c.after(s.$root),s.on({start:s.component.onStart,render:s.component.onRender,stop:s.component.onStop,open:s.component.onOpen,close:s.component.onClose,set:s.component.onSet}).on({start:u.onStart,render:u.onRender,stop:u.onStop,open:u.onOpen,close:u.onClose,set:u.onSet}),i=function(e){var t,n="position";e.currentStyle?t=e.currentStyle[n]:window.getComputedStyle&&(t=getComputedStyle(e)[n]);return"fixed"==t}(s.$holder[0]),r.autofocus&&s.open(),s.trigger("start").trigger("render"))},render:function(e){return e?(s.$holder=m(l()),f(),s.$root.html(s.$holder)):s.$root.find("."+a.box).html(s.component.nodes(d.open)),s.trigger("render")},stop:function(){return d.start&&(s.close(),s._hidden&&s._hidden.parentNode.removeChild(s._hidden),s.$root.remove(),c.removeClass(a.input).removeData(e),setTimeout(function(){c.off("."+d.id)},0),r.type=d.type,r.readOnly=!1,s.trigger("stop"),d.methods={},d.start=!1),s},open:function(e){return d.open?s:(c.addClass(a.active),b(r,"expanded",!0),setTimeout(function(){s.$root.addClass(a.opened),b(s.$root[0],"hidden",!1)},0),!1!==e&&(d.open=!0,i&&m("body").css("overflow","hidden").css("padding-right","+="+_()),i&&v?s.$holder.find("."+a.frame).one("transitionend",function(){s.$holder.eq(0).focus()}):setTimeout(function(){s.$holder.eq(0).focus()},0),g.on("click."+d.id+" focusin."+d.id,function(e){var t=$(e,r);e.isSimulated||t==r||t==document||3==e.which||s.close(t===s.$holder[0])}).on("keydown."+d.id,function(e){var t=e.keyCode,n=s.component.key[t],o=$(e,r);27==t?s.close(!0):o!=s.$holder[0]||!n&&13!=t?m.contains(s.$root[0],o)&&13==t&&(e.preventDefault(),o.click()):(e.preventDefault(),n?y._.trigger(s.component.key.go,s,[y._.trigger(n)]):s.$root.find("."+a.highlighted).hasClass(a.disabled)||(s.set("select",s.component.item.highlight),u.closeOnSelect&&s.close(!0)))})),s.trigger("open"))},close:function(e){return e&&(u.editable?r.focus():(s.$holder.off("focus.toOpen").focus(),setTimeout(function(){s.$holder.on("focus.toOpen",p)},0))),c.removeClass(a.active),b(r,"expanded",!1),setTimeout(function(){s.$root.removeClass(a.opened+" "+a.focused),b(s.$root[0],"hidden",!0)},0),d.open?(d.open=!1,i&&m("body").css("overflow","").css("padding-right","-="+_()),g.off("."+d.id),s.trigger("close")):s},clear:function(e){return s.set("clear",null,e)},set:function(e,t,n){var o,r,i=m.isPlainObject(e),a=i?e:{};if(n=i&&m.isPlainObject(t)?t:n||{},e){for(o in i||(a[e]=t),a)r=a[o],o in s.component.item&&(void 0===r&&(r=null),s.component.set(o,r,n)),"select"!=o&&"clear"!=o||!u.updateInput||c.val("clear"==o?"":s.get(o,u.format)).trigger("change");s.render()}return n.muted?s:s.trigger("set",a)},get:function(e,t){if(null!=d[e=e||"value"])return d[e];if("valueSubmit"==e){if(s._hidden)return s._hidden.value;e="value"}if("value"==e)return r.value;if(e in s.component.item){if("string"!=typeof t)return s.component.get(e);e=s.component.get(e);return e?y._.trigger(s.component.formats.toString,s.component,[t,e]):""}},on:function(e,t,n){var o,r,i=m.isPlainObject(e),a=i?e:{};if(e)for(o in i||(a[e]=t),a)r=a[o],d.methods[o=n?"_"+o:o]=d.methods[o]||[],d.methods[o].push(r);return s},off:function(){var e,t=arguments,n=0;for(namesCount=t.length;n<namesCount;n+=1)(e=t[n])in d.methods&&delete d.methods[e];return s},trigger:function(e,t){function n(e){(e=d.methods[e])&&e.map(function(e){y._.trigger(e,s,[t])})}return n("_"+e),n(e),s}};function l(){return y._.node("div",y._.node("div",y._.node("div",y._.node("div",s.component.nodes(d.open),a.box),a.wrap),a.frame),a.holder,'tabindex="-1"')}function f(){s.$holder.on({keydown:h,"focus.toOpen":p,blur:function(){c.removeClass(a.target)},focusin:function(e){s.$root.removeClass(a.focused),e.stopPropagation()},"mousedown click":function(e){var t=$(e,r);t!=s.$holder[0]&&(e.stopPropagation(),"mousedown"!=e.type||m(t).is("input, select, textarea, button, option")||(e.preventDefault(),s.$holder.eq(0).focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var e=m(this),t=e.data(),n=e.hasClass(a.navDisabled)||e.hasClass(a.disabled),e=(e=x())&&(e.type||e.href?e:null);(n||e&&!m.contains(s.$root[0],e))&&s.$holder.eq(0).focus(),!n&&t.nav?s.set("highlight",s.component.item.highlight,{nav:t.nav}):!n&&"pick"in t?(s.set("select",t.pick),u.closeOnSelect&&s.close(!0)):t.clear?(s.clear(),u.closeOnClear&&s.close(!0)):t.close&&s.close(!0)})}function p(e){e.stopPropagation(),c.addClass(a.target),s.$root.addClass(a.focused),s.open()}function h(e){var t=e.keyCode,n=/^(8|46)$/.test(t);if(27==t)return s.close(!0),!1;(32==t||n||!d.open&&s.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?s.clear().close():s.open())}return new o}function _(){if(r.height()<=o.height())return 0;var e=m('<div style="visibility:hidden;width:100px" />').appendTo("body"),t=e[0].offsetWidth;e.css("overflow","scroll");var n=m('<div style="width:100%" />').appendTo(e)[0].offsetWidth;return e.remove(),t-n}function $(e,t){var n=[];return e.path&&(n=e.path),(n=e.originalEvent&&e.originalEvent.path?e.originalEvent.path:n)&&0<n.length?t&&0<=n.indexOf(t)?t:n[0]:e.target}function b(e,t,n){if(m.isPlainObject(t))for(var o in t)i(e,o,t[o]);else i(e,t,n)}function i(e,t,n){e.setAttribute(("role"==t?"":"aria-")+t,n)}function x(){try{return document.activeElement}catch(e){}}return y.klasses=function(e){return{picker:e=e||"picker",opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",target:e+"__input--target",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},y._={group:function(e){for(var t,n="",o=y._.trigger(e.min,e);o<=y._.trigger(e.max,e,[o]);o+=e.i)t=y._.trigger(e.item,e,[o]),n+=y._.node(e.node,t[0],t[1],t[2]);return n},node:function(e,t,n,o){return t?"<"+e+(n=n?' class="'+n+'"':"")+(o=o?" "+o:"")+">"+(t=m.isArray(t)?t.join(""):t)+"</"+e+">":""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return-1<{}.toString.call(e).indexOf("Date")&&this.isInteger(e.getDate())},isInteger:function(e){return-1<{}.toString.call(e).indexOf("Number")&&e%1==0},ariaAttr:function(e,t){m.isPlainObject(e)||(e={attribute:t});for(var n in t="",e){var o=("role"==n?"":"aria-")+n,r=e[n];t+=null==r?"":o+'="'+e[n]+'"'}return t}},y.extend=function(o,r){m.fn[o]=function(e,t){var n=this.data(o);return"picker"==e?n:n&&"string"==typeof e?y._.trigger(n[e],n,[t]):this.each(function(){m(this).data(o)||new y(this,o,r,e)})},m.fn[o].defaults=r.defaults},y});